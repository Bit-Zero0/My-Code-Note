---
Type: Note
tags:
  - 汇编
Status: writing
start-date: 2024-06-09 13:46
Finish-date: 
Modified-date: 2024-06-09 22:00
---

# 本文摘要
学习和使用 DOSBox 环境下的汇编debug, 掌握基本常用命令

## 前提知识
学习汇编的Debug前, 需要[[汇编语言环境的搭建#安装DOSBox|安装DOSBox]]环境, 并且有 debug.exe可执行文件. 这些必要工具在[[汇编语言环境的搭建]]文章中都有. 


# 前言


> [!question]+ Debug是什么?
> Debug是DOS系统中的著名的调试程序，也可以运行在windows系统实模式下。
> 
> 使用Debug程序，可以查看CPU各种寄存器中的内容、内存的情况，并且在机器指令级跟踪程序的运行！


> [!question]+ Debug能做什么?
> 用`R`命令查看、改变CPU寄存器的内容
> 用`D`命令查看内存中的内容
> 用`E`命令改变内存中的内容
> 用`U`命令将内存中的机器指令翻译成汇编指令
> 用`A`命令以汇编指令的格式在内存中写入机器指令
> 用`T`命令执行机器指令


# Debug的使用
使用前提使用安装了DOSBox环境, 并挂载工作目录, 请先看[[汇编语言环境的搭建]]
## 启动Debug
> [!warning]- 注意事项:
> - 打开DOSBox后的第一件事: 挂载工作目录 `mount C 工作目录`
> 	- ![[DOSBox挂载工作目录图.png|327]]
> - 然后切换盘符 `C:`
> 	- ![[DOSBox切换盘符图.png|367]]

在DOS提示符下输入命令：`debug`
```z80
C:\> debug
-
```
出现一个 `-` , 表示debug运行成功. 此时可以直接输入指令. 

接下来我们一起学习一下Debug的指令.
## Debug的指令

### R 指令
作用: **用R命令查看、改变CPU寄存器的内容**
> [!tip]+ 总览
> - `-R` - 查看寄存器内容.
> - `-R 寄存器名` - 改变指定寄存器内容.


`-R` - 查看寄存器内容
![[Pasted image 20240609140937.png]]


`-R 寄存器名` - 改变指定寄存器内容
![[Pasted image 20240609141146.png]]


### D 指令
作用: **用D命令查看内存中的内容**
> [!tip]+ 总览
> - `-D` :  列出预设地址内存处的128个字节的内容.
> - `-D 段地址:偏移地址` : 列出内存中指定地址处的内容.
> - `-D 段地址:偏移地址 结尾偏移地址` : 列出内存中指定地址范围内的内容.

`-D` :  列出预设地址内存处的128个字节的内容.
![[Pasted image 20240609141711.png]]

 
 `-D 段地址:偏移地址` : 列出内存中指定地址处的内容. 如: 我们访问的段地址和偏移地址为**CS:IP**的地址, 也就是`073f:0100`, 这个偏移地址组合很重要, 之后会详细讲.
 ![[Pasted image 20240609142026.png]]
 
`-D 段地址:偏移地址 结尾偏移地址` : 列出内存中指定地址范围内的内容.
![[Pasted image 20240609152444.png]]
![[Pasted image 20240609152412.png]]

### E 指令
作用: **用E命令改变内存中的内容**

> [!tip]+ 总览
> -  `E 段地址:偏移地址 数据1 数据2 ...`
> -  `E 段地址:偏移地址`
> 	-  逐个询问式修改
> 	-  空格 - 接受，继续
> 	-  回车 - 结束

`E 段地址:偏移地址 数据1 数据2 ...`
![[Pasted image 20240609150140.png]]

  `E 段地址:偏移地址`
 	-  逐个询问式修改
 	-  空格 - 接受，继续
 	-  回车 - 结束
![[Pasted image 20240609150532.png]]

### U指令
作用: 用U命令将内存中的机器指令翻译成汇编指令

==**用中学**==
```z80
-e 073f:0100 B8 23 01 BB 03 00 89 D8 01 D8  ;写入机器码数据

-d 073f:0100    ;查看数据

-u ;查看汇编指令

-u 073f:0100    ; 查看指定内容数据

-u 073f:0100 0108  ; 可指定偏移地址
```


### A指令
作用: 用A命令以汇编指令的格式在内存中写入机器指令

```z80
-a
;输入以下指令
mov ax, 0123H
mov bx, 0003H
mov ax, bx
add ax, bx

-d 073f:0100    ;查看数据

-u 073f:0100 0108  ; 查看代码
```

![[Pasted image 20240609152942.png]]

指令以及写入, 那要如何执行呢? 那就需要用到 T 指令了
### T指令
作用: 执行机器指令

`-t` :  执行CS:IP处的指令 , 也就是我们
```z80
mov ax, 0123H
mov bx, 0003H
mov ax, bx
add ax, bx
```

![[Pasted image 20240609153443.png]]

注意看寄存器的AX , BX寄存器的变化. 


> [!question]+ 你发现 IP 寄存器的变化了吗? 
> 它好像与我们的指令有关, 它会自动变化.  详细内容请看[[访问寄存器和内存#CS, IP 与代码段]]


### Q指令
作用: 退出Debug


# 总结
- 用`R`命令查看、改变CPU寄存器的内容  
- 用`D`命令 **==查看==内存中的内容**  
- 用`E`命令 **==改变==内存中的内容**  
- 用`U`命令将**内存中的机器指令翻译成汇编指令**  
- 用`A`命令**==以汇编指令的格式在内存中写入机器指令==**  
- 用`T`命令==**执行**==机器指令


Debug的这些指令都非常重要, 请勤加练习