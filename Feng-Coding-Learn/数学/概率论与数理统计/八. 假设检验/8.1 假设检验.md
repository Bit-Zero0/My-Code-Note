---
Type: Note
tags:
  - 概率论
  - 数学
Status: writing
Start-date: 2025-01-01 17:47
Finish-date: 
Modified-date: 2025-01-08 12:11
Publish: false
---

# 假设检验
在统计学中，==**假设检验**==是一种用数据来判断统计假设是否成立的方法。简单来说，就像是在法庭上，我们需要通过证据（数据）来判断被告是否有罪（假设）。

> [!note] 小贴士
> 假设检验的基本思想是：先提出一个假设，然后通过样本数据来判断这个假设是否合理。如果样本数据与假设严重不符，我们就否定这个假设；如果样本数据与假设基本符合，我们就接受这个假设。

## 基本概念

1. ==原假设== ($H_0$)：我们最初提出需要检验的假设
2. ==备择假设== ($H_1$)：与原假设相对的假设
3. **显著性水平** ($\alpha$)：犯第一类错误的概率，通常取0.05或0.01
4. **检验统计量**：用于进行检验的随机变量




## 正态总体下均值$\mu$的假设检验

### 解题步骤
#### 第1步：提出假设
- 零假设 $H_0: \mu = \mu_0$
- 备择假设 $H_1: \mu \neq \mu_0$

#### 第2步：选择检验统计量
1. 当总体方差 $\sigma^2$ ==已知==时，使用标准正态分布的检验统计量：
   $$Z = \frac{\overline{X} - \mu_0}{\sigma / \sqrt{n}} \sim N(0,1)$$
   (Z检验)

2. 当总体方差 $\sigma^2$ ==未知==时，使用 t 分布的检验统计量：
   $$T = \frac{\overline{X} - \mu_0}{S / \sqrt{n}} \sim t(n-1)$$
   (T检验)

#### 第3步：确定拒绝域
1. 对于 Z 检验，拒绝域可能为：
   $$W = (-\infty, -z_{\alpha/2}) \cup (z_{\alpha/2}, +\infty)$$
   其中 $z_{\alpha/2}$ 是标准正态分布的临界值。

2. 对于 T 检验，拒绝域可能为：
   $$W = (-\infty, -t_{\alpha/2, n-1}) \cup (t_{\alpha/2, n-1}, +\infty)$$
   其中 $t_{\alpha/2, n-1}$ 是 t 分布的临界值，自由度为 $n-1$。

#### 第4步：作出检验
- 计算检验统计量的值。
- 如果检验统计量的值落在拒绝域内，则拒绝零假设 $H_0$。


### U检验（$\sigma$已知）

当总体标准差$\sigma$已知时，我们使用U检验。

检验统计量：$U = \frac{\bar{X} - \mu_0}{\sigma/\sqrt{n}}$

> [!example] 例题
> 某工厂生产的零件，声称平均长度为50mm。现随机抽取100个零件测量，样本均值为49.8mm，总体标准差已知为1mm，试在显著性水平0.05下检验该声称是否正确。
> 
> 解析：
> 1. $H_0: \mu = 50$，$H_1: \mu \neq 50$
> 2. $U = \frac{49.8 - 50}{1/\sqrt{100}} = -2$
> 3. 查表得$u_{0.025} = 1.96$
> 4. 因为$|-2| > 1.96$，所以拒绝$H_0$
> 5. 结论：该工厂的声称不正确

###  T检验（$\sigma$未知）

当总体标准差$\sigma$未知时，使用T检验。

检验统计量：
$$t = \frac{\bar{X} - \mu_0}{S/\sqrt{n}}$$


> [!example]+ 示例
> **题目**：假设我们有一个样本，包含10名学生在数学测试中的分数，我们想要检验这些学生的数学成绩是否显著高于80分。样本数据如下：
> 
> $85, 90, 78, 88, 92, 84, 81, 89, 77, 93$
> 
> 我们假设总体成绩服从正态分布，但方差未知。我们想要以95%的置信水平检验学生的平均成绩是否显著高于80分。
> 
> **解答**：
> 
> 1. **提出假设**：
>    - 零假设 $H_0: \mu = 80$（学生的平均成绩等于80分）
>    - 备择假设 $H_1: \mu > 80$（学生的平均成绩高于80分）
> 
> 2. **计算样本统计量**：
>    - 样本均值 $\overline{X} = \frac{85 + 90 + 78 + 88 + 92 + 84 + 81 + 89 + 77 + 93}{10} = 85.8$
>    - 样本标准差 $S = \sqrt{\frac{\sum_{i=1}^{10} (X_i - \overline{X})^2}{9}} \approx 5.37$
> 
> 3. **选择检验统计量**：
>    - 使用单样本T检验统计量：$T = \frac{\overline{X} - \mu_0}{S / \sqrt{n}} = \frac{85.8 - 80}{5.37 / \sqrt{10}} \approx 2.68$
> 
> 4. **确定拒绝域**：
>    - 对于95%的置信水平，自由度为 $n-1 = 9$，查找t分布表得到临界值 $t_{0.05, 9} \approx 1.833$。
> 
> 5. **作出决策**：
>    - 由于计算得到的T值（2.68）大于临界值（1.833），我们拒绝零假设，认为学生的平均成绩显著高于80分。



## 正态总体下方差$\sigma^2$的假设检验($\chi^2$检验)

使用$\chi^2$检验来检验方差。

检验统计量：$$\chi^2 = \frac{(n-1)S^2}{\sigma_0^2}$$

> [!tip] 重要提示
> 1. ==检验方法的选择取决于已知条件==
> 2. ==**合理设置显著性水平很重要**==
> 3. 结论表述要准确规范


当正态总体的均值 $\mu$ ==未知==时，我们可以使用卡方检验来对总体方差 $\sigma^2$ 进行假设检验。

### 解题步骤

1. **提出假设**：
   - 零假设 $H_0: \sigma^2 = \sigma_0^2$
   - 备择假设 $H_1: \sigma^2 \neq \sigma_0^2$

2. **计算自由度**：自由度为 $n-1$。

3. **查找卡方分布的临界值**：对于给定的置信水平和自由度，查找卡方分布的临界值 $\chi^2_{\alpha/2, n-1}$ 和 $\chi^2_{1-\alpha/2, n-1}$。

4. **构建置信区间**：方差 $\sigma^2$ 的置信区间由以下公式给出：
   $$\frac{(n-1)S^2}{\chi^2_{1-\alpha/2, n-1}} < \sigma^2 < \frac{(n-1)S^2}{\chi^2_{\alpha/2, n-1}}$$

这意味着我们有 $(1 - \alpha) \times 100\%$ 的信心认为总体方差 $\sigma^2$ 落在这个区间内。


> [!example]+ 示例1
> 假设样本大小 $n = 25$，样本方差 $S^2 = 4$，我们想要构建 $\sigma^2$ 的 95% 置信区间。
> 
> 1. **自由度**：$n-1 = 24$。
> 
> 2. **临界值**：对于 95% 置信水平，自由度为 24，查卡方分布表得到 $\chi^2_{0.975, 24} \approx 13.848$ 和 $\chi^2_{0.025, 24} \approx 39.364$。
> 
> 3. **置信区间**：
>    $\frac{24 \times 4}{39.364} < \sigma^2 < \frac{24 \times 4}{13.848}$
>    $2.03 < \sigma^2 < 7.21$
> 
> 因此，我们有 95% 的信心认为总体方差 $\sigma^2$ 落在 2.03 到 7.21 之间。


> [!example]+ 示例2
> **题目**：已知某厂生产的某种零件的长度 $X$ 服从正态分布 $N(\mu, \sigma^2)$。现从一批零件中随机抽取 16 个，测得样本方差 $s^2 = 0.048^2$。在显著性水平 $\alpha = 0.05$ 下，检验这批零件长度的方差是否为 $0.05^2$。
> 
> **解答**：
> 
> 1. **提出假设**：
>    - 零假设 $H_0: \sigma^2 = 0.05^2$
>    - 备择假设 $H_1: \sigma^2 \neq 0.05^2$
> 
> 2. **计算自由度**：自由度为 $n-1 = 16-1 = 15$。
> 
> 3. **查找卡方分布的临界值**：对于 95% 的显著性水平和自由度 15，查找卡方分布表得到临界值 $\chi^2_{\alpha/2, 15}$ 和 $\chi^2_{1-\alpha/2, 15}$。
> 
> 4. **构建置信区间**：方差 $\sigma^2$ 的置信区间由以下公式给出：
>    $\frac{(n-1)s^2}{\chi^2_{1-\alpha/2, 15}} < \sigma^2 < \frac{(n-1)s^2}{\chi^2_{\alpha/2, 15}}$
> 
> 5. **计算检验统计量**：首先，我们需要计算检验统计量，即：
>    $\chi^2 = \frac{(n-1)s^2}{\sigma_0^2} = \frac{15 \times 0.048^2}{0.05^2}$
> 
> 6. **确定拒绝域**：假设查表得到的临界值为 $\chi^2_{0.025, 15} \approx 27.488$ 和 $\chi^2_{0.975, 15} \approx 6.262$。
> 
> 7. **作出决策**：如果计算得到的 $\chi^2$ 值落在拒绝域内（即小于 6.262 或大于 27.488），则拒绝零假设。在这个例子中，我们首先需要计算 $\chi^2$ 值。
> 
> $\chi^2 = \frac{15 \times 0.048^2}{0.05^2} = \frac{15 \times 0.002304}{0.0025} = 34.56$
> 
> 由于 34.56 大于 27.488，我们拒绝零假设，认为这批零件长度的方差显著不等于 $0.05^2$。
> 

好的,我来为您生成5道关于假设检验的习题:

## 练习题
1. 某工厂生产的灯泡,声称其寿命服从正态分布,平均寿命为1000小时。为检验这一说法,随机抽取36只灯泡进行测试,得到样本平均寿命为980小时,样本标准差为60小时。在显著性水平0.05下,检验该工厂的声称是否正确。

> [!note]- 解题思路
> 1. 由于样本量n=36较大,且总体标准差未知,可以使用t检验
> 2. 建立假设:H₀:μ=1000, H₁:μ≠1000
> 3. 计算检验统计量t值
> 4. 查找临界值并做出判断

> [!success]- 详细解答
> 1. 检验统计量:
>    t = (x̄-μ₀)/(s/√n) = (980-1000)/(60/√36) = -2
> 2. 自由度:df = n-1 = 35
> 3. 查表得$t_{0.025}(35) = 2.03$
> 4. 因为|-2| < 2.03,所以接受H₀
> 5. 结论:在0.05的显著性水平下,没有足够证据否定工厂的声称


2. 某医生研发了一种新的降压药,为验证其效果,随机选取25名高血压患者服用该药物。服用一个月后测得血压下降值(单位:mmHg)的样本均值为15,样本标准差为8。问在0.01的显著性水平下,能否认为该药物具有显著的降压效果?

> [!note]- 解题思路
> 1. 这是单样本t检验
> 2. H₀:μ=0(无降压效果), H₁:μ>0(有降压效果)
> 3. 使用右侧检验

> [!success]- 详细解答
> 1. 检验统计量:
>    t = (15-0)/(8/√25) = 9.375
> 2. 自由度:df = 24
> 3. 查表得$t_{0.01}(24) = 2.492$
> 4. 因为9.375 > 2.492,所以拒绝H₀
> 5. 结论:在0.01的显著性水平下,该药物具有显著的降压效果


3. 某厂生产的零件,其长度服从正态分布。从一批产品中随机抽取16个测量,得样本方差s²=0.04。在显著性水平0.05下,检验总体方差是否等于0.03。

> [!note]- 解题思路
> 1. 这是方差的χ²检验
> 2. H₀:σ²=0.03, H₁:σ²≠0.03
> 3. 计算χ²统计量并进行双侧检验

> [!success]- 详细解答
> 1. χ² = (n-1)s²/σ₀² = 15×0.04/0.03 = 20
> 2. 自由度:df = 15
> 3. 查表得χ²₀.₉₇₅(15) = 27.488, χ²₀.₀₂₅(15) = 6.262
> 4. 因为6.262 < 20 < 27.488,所以接受H₀
> 5. 结论:在0.05的显著性水平下,没有足够证据否定总体方差等于0.03


4. 某公司声称其生产的电池平均寿命超过100小时。随机抽取9块电池测试,得到寿命(小时):102,98,105,96,103,99,97,101,104。假设总体服从正态分布,在0.05的显著性水平下检验该声称是否正确。

> [!note]- 解题思路
> 1. 样本量小于30,使用t检验
> 2. H₀:μ=100, H₁:μ>100
> 3. 需要先计算样本均值和标准差

> [!success]- 详细解答
> 1. 计算样本均值x̄=100.56,样本标准差s=3.09
> 2. t = (100.56-100)/(3.09/√9) = 0.54
> 3. 自由度:df = 8
> 4. 查表得t₀.₀₅(8) = 1.860
> 5. 因为0.54 < 1.860,所以接受H₀
> 6. 结论:在0.05的显著性水平下,不能认为电池平均寿命显著超过100小时


5. 某测量仪器声称其测量误差的标准差为0.02mm。为检验这一说法,进行了20次重复测量,得到样本方差s²=0.0005mm²。在显著性水平0.01下,检验该声称是否正确。

> [!note]- 解题思路
> 1. 这是方差的χ²检验
> 2. H₀:σ²=0.0004, H₁:σ²≠0.0004 (注意:0.02²=0.0004)
> 3. 使用双侧检验

> [!success]- 详细解答
> 1. χ² = (n-1)s²/σ₀² = 19×0.0005/0.0004 = 23.75
> 2. 自由度:df = 19
> 3. 查表得χ²₀.₉₉₅(19) = 38.582, χ²₀.₀₀₅(19) = 6.844
> 4. 因为6.844 < 23.75 < 38.582,所以接受H₀
> 5. 结论:在0.01的显著性水平下,没有足够证据否定仪器的声称
