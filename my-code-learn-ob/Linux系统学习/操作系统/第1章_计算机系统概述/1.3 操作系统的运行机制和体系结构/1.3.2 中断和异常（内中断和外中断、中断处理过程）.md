![[Pasted image 20220515122306.png]]

# 1.中断机制的诞生
为了实现多道程序并发执行的一种技术，为了提高资源利用率。

# 2.中断的概念和作用

## 中断的概念
==发生中断==则意味着需要==操作系统介入开展管理工作==，cpu会立即进入[[1.3.1 操作系统的运行机制和体系结构（大内核、小内核）#两种处理器状态 | 核心态]]。

## 中断的作用
>“==**中断**==” 是==进入核心态的**唯一**途径==。


# 3.中断的分类
我们说的==中断==其实是**广义的**中断 ， 包含==**内中断**== 和 ==**外中断**==。

==外中断==也就是 ==狭义的中断==。

## 内中断（也称异常，例外、陷入）
内中断的信号来源于cpu内部，与当前执行的指令有关。

### 自愿中断
#### 指令中断
>如:系统调用时使用的访管指令(又叫陷入指令,trap指令);


### 强迫中断
#### 硬件故障
>如: 缺页；

#### 软件中断
>如：整数除0；

### 陷阱、陷入（trap）
有意为之的异常。如系统调用；

### 故障（fault）
由错误条件引起的，可能被故障处理程序修复。如：缺页。

### 终止（abort）
**不可恢复**的**致命错误**造成的结果，终止处理程序不再将控制返回给引发终止的应用程序。如：整数除以0

## 外中断
### 外设要求
>如：I/O操作完成发出的中断信号。

### 人工干预
>如：用户强行终止一个程序。


# 4.中断（指外中断）的处理过程

^b82bd9

从1 - 9 顺序执行

## 1、关中断 （硬件完成）
cpu响应中断后，应该拒绝响应更高级的中断源的中断请求。

## 2、保存断点（硬件完成）
为了之后能重新恢复执行这个程序，需要将原来的程序的断点（即程序计数PC）保存起来。

## 3、中断服务程序寻址（硬件完成）
取出中断服务程序的入口地址送到程序十数器PC。

## 4、保存现场和屏蔽字（中断程序完成）
进入程序中断服务程序后，首先要保护现场，现场信息一股是指程序状态字寄存器PSWR和其些通用寄存器的内容。

## 5、开中断（中断程序完成）
允许更高级中断请求得到响应，想象一下多道程序设计的并发执行，CPU交替执行内存里面的各个程序。

## 6、执行中断服务程序（中断程序完成）
这是中断请求的目的，完成某些中断后的操作。

## 7、关中断（中断程序完成）
保证在恢复现场和屏蔽字时不被中断，完成中断后的操作之后，需要恢复现场，不希望被打扰。

## 8. 恢复现场和屏蔽字（中断程序完成）
将现场和屏蔽字恢复到原来的状态。

## 9、开中断->中断返回（中断程序完成）
中断服务程序的最后一条指令通常是一条中断返回指令，使其返回到原程序的断点处，以便继续执行原程序。



