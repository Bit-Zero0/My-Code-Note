{
	"ID": "20221109125804-c4lernx",
	"Type": "NodeDocument",
	"Properties": {
		"id": "20221109125804-c4lernx",
		"title": "网络IO模型",
		"updated": "20221113211955"
	},
	"Children": [
		{
			"ID": "20221113211217-d0yaqrm",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-d0yaqrm",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "网络IO"
				}
			]
		},
		{
			"ID": "20221113211217-g685juq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-g685juq",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "当两个主机进行交互时，各自的传输层都有各自的接受缓冲区和发送缓冲区，而数据不是随时都有的，而是当另一端发送到自己的接收缓冲区后，应用层才能向下到传输层的接收缓冲区中读取数据。\n所以 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "IO==等待数据+拷贝数据"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-1o320pd",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-1o320pd",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-xbju9kv",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-xbju9kv",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "那要怎样提高IO的效率呢？"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-8pciul9",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-8pciul9",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-pj1t63u",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-pj1t63u",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-asxqq4q",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-asxqq4q",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "改变等待数据的方式"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-nk11tup",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-nk11tup",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-4hxpxlv",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-4hxpxlv",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "减少等待的时间比重"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-gqaqglo",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-gqaqglo",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "五种IO模型"
				}
			]
		},
		{
			"ID": "20221113211217-8inrra1",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-8inrra1",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-fx60dlm",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-fx60dlm",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "例子：有五个人去钓鱼，分别是，张三， 李四，王五，赵六， 田七"
						}
					]
				},
				{
					"ID": "20221113211217-lydbhpv",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-lydbhpv",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "张三"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：专心的人，一心一意守着鱼竿。\n"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "李四"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：三心二意的人，虽然守着鱼竿，但时不时的却做其他事。\n"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "王五"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：聪明人，在鱼竿上放好铃铛，铃铛响时则专心钓鱼，不响时则进行其他活动。\n"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "赵六"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：有钱人，在湖边放了很多鱼竿，哪个鱼竿钩住鱼则进行钓鱼\n"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "田七"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：大老板 ， 他不想钓鱼，只想吃鱼，让手下来钓鱼，钓满一桶后手下打电话通知他来取。"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-ie7wtsb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-ie7wtsb",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "张三就是 "
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "阻塞等待(BIO)"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " ：无论是获取新的连接还是读取指定连接的数据，调用操作系统的函数都是阻塞的，如果要实现服务多个连接，就必须每个连接建立一个线程异步处理，否则，当建立起一个连接，但是客户端不发送数据，服务端就会被这个客户端占用，无法接受新的连接。"
				}
			]
		},
		{
			"ID": "20221113211217-ufgihxr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-ufgihxr",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "李四 是 "
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "非阻塞等待(NIO)"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ": 解决了阻塞的问题，程序调用操作系统的函数，如果没有连接或数据，会立即返回，不会阻塞，避免了资源无效浪费。但是，它的问题在于，如果我有1万个连接，每次我需要挨个询问1万次，这个复杂度是O(n)的。每次询问都是一次系统调用，涉及到CPU的用户态内核态切换，成本很高。"
				}
			]
		},
		{
			"ID": "20221113211217-boifp38",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-boifp38",
				"updated": "20221113211229"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "王五 是 "
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "信号驱动"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "："
				},
				{
					"Type": "NodeBlockRef",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeBlockRefID",
							"Data": "20220910184746-mm74fd3"
						},
						{
							"Type": "NodeBlockRefSpace"
						},
						{
							"Type": "NodeBlockRefDynamicText",
							"Data": "Linux信号"
						},
						{
							"Type": "NodeCloseParen"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "，等待系统的信号通知，然后进行处理。"
				}
			]
		},
		{
			"ID": "20221113211217-2xpibry",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-2xpibry",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "赵六 是 "
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "多路转接"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "： IO多路转接能够同时等待多个文件描述符的就绪状态."
				}
			]
		},
		{
			"ID": "20221113211217-y4o335g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-y4o335g",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "田七 是 "
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "异步"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "：由内核在数据拷贝完成时, 通知应用程序(而信号驱动是告诉应用程序何时可以开始拷贝数据).\n\t-  注意这里的异步不是系统概念的异步，网络的异步和系统的异步不是一个概念。\n\t- 网络异步就是这在乎结果，不参与过程"
				}
			]
		},
		{
			"ID": "20221113211322-19ex4te",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211322-19ex4te"
			}
		},
		{
			"ID": "20221113211217-rgjvy0b",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-rgjvy0b",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "阻塞等待(BIO)"
				}
			]
		},
		{
			"ID": "20221113211217-2zttevw",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-2zttevw",
				"updated": "20221113211312"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "阻塞IO: 在内核将数据准备好之前, 系统调用会一直等待. 所有的套接字, 默认都是阻塞方式.\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221106230003"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221106230003-20221113211312-vij6y74.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211317-c4l2jcm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211317-c4l2jcm"
			}
		},
		{
			"ID": "20221113211217-wp8nldg",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-wp8nldg",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "非阻塞等待(NIO)"
				}
			]
		},
		{
			"ID": "20221113211217-3z1tuni",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-3z1tuni",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果内核还未将数据准备好, 系统调用仍然会直接返回, 并且返回"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "EWOULDBLOCK"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "错误码."
				}
			]
		},
		{
			"ID": "20221113211217-sx4ot8e",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-sx4ot8e",
				"updated": "20221113211330"
			},
			"Children": [
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "非阻塞IO往往需要程序员循环的方式反复尝试读写文件描述符"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ", 这个过程称为"
				},
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "轮询"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ". 这对CPU来说是较大的浪费, 一般只有特定场景下才使用.\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221106230130"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221106230130-20221113211330-8537p68.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211334-uth14wm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211334-uth14wm"
			}
		},
		{
			"ID": "20221113211217-05on04b",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-05on04b",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "信号驱动IO"
				}
			]
		},
		{
			"ID": "20221113211217-xej3oz3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-xej3oz3",
				"updated": "20221113211344"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "信号驱动IO: 内核将数据准备好的时候, 使用"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "SIGIO"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "信号()通知应用程序进行IO操作.\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221106230242"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221106230242-20221113211344-rps15de.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211347-vl8lwwr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211347-vl8lwwr"
			}
		},
		{
			"ID": "20221113211217-92aro1t",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-92aro1t",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "多路转接IO"
				}
			]
		},
		{
			"ID": "20221113211217-x53wvm4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-x53wvm4",
				"updated": "20221113211353"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "IO多路转接: 虽然从流程图上看起来和阻塞IO类似. 实际上最核心在于IO多路转接能够同时等待多个文件描述符的就绪状态.\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221106231024"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221106231024-20221113211353-h41bjq5.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211217-7o5l2k1",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-7o5l2k1",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "异步IO"
				}
			]
		},
		{
			"ID": "20221113211217-dww9qts",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-dww9qts",
				"updated": "20221113211358"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "异步IO: 由内核在数据拷贝完成时, 通知应用程序(而信号驱动是告诉应用程序何时可以开始拷贝数据).\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221106231107"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221106231107-20221113211358-fq2x7li.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211217-5bu8x5m",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-5bu8x5m",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "小结"
				}
			]
		},
		{
			"ID": "20221113211217-1rrnqs0",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-1rrnqs0",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "任何IO过程中, 都包含两个步骤. "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "第一是等待, 第二是拷贝"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ". 而且在实际的应用场景中, 等待消耗的时间往\n往都远远高于拷贝的时间. 让IO更高效, 最核心的办法就是让等待的时间尽量少."
				}
			]
		},
		{
			"ID": "20221113211217-4f0173f",
			"Type": "NodeTable",
			"TableAligns": [
				2,
				2,
				2,
				2,
				2,
				2
			],
			"Properties": {
				"colgroup": "|||||",
				"id": "20221113211217-4f0173f",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeTableHead",
					"Data": "thead",
					"Children": [
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "BIO"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "NIO"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "IO多路"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "信号驱动IO"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "异步IO"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "第一阶段"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "非阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "非阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "非阻塞"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "第二阶段"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "阻塞"
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "非阻塞"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211419-2k28ids",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211419-2k28ids",
				"updated": "20221113211430"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221107120859"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221107120859-20221113211430-tae87ux.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211425-bx6jw2x",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211425-bx6jw2x"
			}
		},
		{
			"ID": "20221113211217-7eji4ra",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-7eji4ra",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "网络IO的重要概念"
				}
			]
		},
		{
			"ID": "20221113211217-2e9zh1d",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-2e9zh1d",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "同步通信 vs 异步通信(synchronous communication/ asynchronous communication)"
				}
			]
		},
		{
			"ID": "20221113211217-7ga9khd",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-7ga9khd",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "同步和异步关注的是消息通信机制."
				}
			]
		},
		{
			"ID": "20221113211217-43b0c4m",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-43b0c4m",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-r2aj5f5",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-r2aj5f5",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-3lbv899",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-3lbv899",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-tu8ijvm",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-tu8ijvm",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "所谓同步，就是在发出一个调用时，在没有得到结果之前，该调用就不返回. 但是一旦调用返回，就得到返回值了; 换句话说，就是由调用者主动等待这个调用的结果;"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-2zfl3jc",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-2zfl3jc",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-kikj7t4",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-kikj7t4",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "异步则是相反，调用在发出之后，这个调用就直接返回了，所以没有返回结果; 换句话说，当一个异步过程调用发出后，调用者不会立刻得到结果; 而是在调用发出后，被调用者通过状态、通知来通知调用者，或通过回调函数处理这个调用."
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-a64n0e2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-a64n0e2",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "另外, 我们回忆在讲多进程多线程的时候, 也提到同步和互斥. 这里的同步通信和进程之间的同步是完全不想干的概念."
				}
			]
		},
		{
			"ID": "20221113211217-k2doiex",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-k2doiex",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-rdkro6q",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-rdkro6q",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-50s51uz",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-50s51uz",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-oa13c4o",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-oa13c4o",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "进程/线程同步也是进程/线程之间直接的制约关系"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-1rgfc33",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-1rgfc33",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-mqtzbth",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-mqtzbth",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "是为完成某种任务而建立的两个或多个线程，这个线程需要在某些位置上协调他们的工作次序而等待、传递信息所产生的制约关系. 尤其是在访问临界资源的时候."
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-sk8yvhy",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-sk8yvhy",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "以后在看到 \"同步\" 这个词, 一定要先搞清楚大背景是什么. 这个同步, 是同步通信异步通信的同步, 还是同步\n与互斥的同步."
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211445-z4mrhx6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211445-z4mrhx6"
			}
		},
		{
			"ID": "20221113211217-qqiyfvq",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-qqiyfvq",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "阻塞 vs 非阻塞"
				}
			]
		},
		{
			"ID": "20221113211217-sqecj6h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-sqecj6h",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "阻塞和非阻塞关注的是程序在等待调用结果（消息，返回值）时的状态."
				}
			]
		},
		{
			"ID": "20221113211217-kd3tdu5",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-kd3tdu5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-j70hkit",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-j70hkit",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-4astebn",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-4astebn",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-9408yi2",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-9408yi2",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "阻塞调用是指调用结果返回之前，当前线程会被挂起. 调用线程只有在得到结果之后才会返回."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-xqbowuz",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-xqbowuz",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-jego3ii",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-jego3ii",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "非阻塞调用指在不能立刻得到结果之前，该调用不会阻塞当前线程."
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-dntq9wy",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-dntq9wy",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "非阻塞IO"
				}
			]
		},
		{
			"ID": "20221113211217-h2eiekl",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-h2eiekl",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "fcntl函数"
				}
			]
		},
		{
			"ID": "20221113211217-wddgt3g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-wddgt3g",
				"updated": "20221113211508"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "一个文件描述符, 默认都是阻塞IO.\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221108160823"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221108160823-20221113211508-k0ul8ex.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211217-wmo04m4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-wmo04m4",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "传入的cmd的值不同, 后面追加的参数也不相同."
				}
			]
		},
		{
			"ID": "20221113211217-td1to60",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-td1to60",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "fcntl函数有5种功能:"
				}
			]
		},
		{
			"ID": "20221113211217-6tqq00e",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-6tqq00e",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-k03mugx",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-k03mugx",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-pvsucd5",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-pvsucd5",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-lyfoc2o",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-lyfoc2o",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "复制一个现有的描述符（cmd=F_DUPFD）."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-12jci1c",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-12jci1c",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-6musttp",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-6musttp",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "获得/设置文件描述符标记(cmd=F_GETFD或F_SETFD)."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-e1e2r7f",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-e1e2r7f",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-t5fhua3",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-t5fhua3",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "获得/设置文件状态标记(cmd=F_GETFL或F_SETFL)."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-nj0fosy",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-nj0fosy",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-j7fxx1d",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-j7fxx1d",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "获得/设置异步I/O所有权(cmd=F_GETOWN或F_SETOWN)."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-cmc7byt",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-cmc7byt",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-utt4koe",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-utt4koe",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "获得/设置记录锁(cmd=F_GETLK,F_SETLK或F_SETLKW)."
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-6c8c3nq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-6c8c3nq",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "我们此处只是用第三种功能, 获取/设置文件状态标记, 就可以将一个文件描述符设置为非阻塞."
				}
			]
		},
		{
			"ID": "20221113211217-4ng3sxg",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-4ng3sxg",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "实现函数SetNoBlock"
				}
			]
		},
		{
			"ID": "20221113211217-szo7fuh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-szo7fuh",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "基于"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "fcntl()"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ", 我们实现一个SetNoBlock函数, 将文件描述符设置为"
				},
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "非阻塞"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "."
				}
			]
		},
		{
			"ID": "20221113211217-chlq5jj",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-chlq5jj",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "void SetNonBlock(int fd)\n{\n    int fl = fcntl(fd, F_GETFL);//取得 fd的标志位\n    if(fl\u003c0)\n    {\n        perror(\"fcntl\");\n        return;\n    }\n\n    fcntl(fd, F_SETFL, fl | O_NONBLOCK); //设置 fd 的标志位\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-qizduof",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-qizduof",
				"updated": "20221113211530"
			},
			"Children": [
				{
					"ID": "20221113211217-3sdibrx",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-3sdibrx",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-2qe42ig",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-2qe42ig",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "使用"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "F_GETFL"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "将当前的文件描述符的属性取出来(这是一个位图)."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-7usj03m",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-7usj03m",
						"updated": "20221113211530"
					},
					"Children": [
						{
							"ID": "20221113211217-25p41a5",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-25p41a5",
								"updated": "20221113211530"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "然后再使用"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "F_SETFL"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "将文件描述符设置回去. 设置回去的同时, 加上一个"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "O_NONBLOCK"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "参数.\n​"
								},
								{
									"Type": "NodeImage",
									"Data": "span",
									"Children": [
										{
											"Type": "NodeBang"
										},
										{
											"Type": "NodeOpenBracket"
										},
										{
											"Type": "NodeLinkText",
											"Data": "Pasted image 20221108163225"
										},
										{
											"Type": "NodeCloseBracket"
										},
										{
											"Type": "NodeOpenParen"
										},
										{
											"Type": "NodeLinkDest",
											"Data": "assets/Pasted image 20221108163225-20221113211530-uk1j2pn.png"
										},
										{
											"Type": "NodeCloseParen"
										}
									]
								},
								{
									"Type": "NodeBr",
									"Data": "br"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-hj4lxja",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-hj4lxja",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#include \u003cstdio.h\u003e\n#include \u003cfcntl.h\u003e\n#include \u003cunistd.h\u003e\n#include \u003cstring.h\u003e\n#include \u003cerrno.h\u003e\n#include \u003cstdlib.h\u003e\n\nvoid setNoBlock(int fd)\n{\n\tint f1 = fcntl(fd, F_GETFL);\n\n\tif (f1 \u003c 0)\n\t{\n\t\tperror(\"fcntl\");\n\t\texit(1);\n\t}\n\n\tfcntl(fd, F_SETFL, f1 | O_NONBLOCK);\n}\n\nint main()\n{\n\tsetNoBlock(0);\n\n\twhile (1)\n\t{\n\t\tchar buffer[1024];\n\t\tssize_t s = read(1, buffer, strlen(buffer));\n\t\tif (s \u003e 0)\n\t\t{\n\t\t\tbuffer[s] = 0;\n\t\t\twrite(1, buffer, strlen(buffer));\n\t\t\tprintf(\"read success , s:%d , errno:%d \\n\", s, errno);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (errno == EAGAIN || errno == EWOULDBLOCK)\n\t\t\t{\n\t\t\t\tprintf(\"数据没有准备好，再试试吧!\\n\");\n\t\t\t\tprintf(\"read failed, s: %d, errno: %d\\n\", s, errno);\n\t\t\t\t//做做其他事情\n\t\t\t\tsleep(1);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-sztz83u",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-sztz83u",
				"updated": "20221113211541"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221108173010"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221108173010-20221113211541-7kcnqr5.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-8z5f4b2",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-8z5f4b2",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-imvwf0e",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-imvwf0e",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "在非阻塞情况下，我们读取数据，如果数据没有就绪，系统是以出错的形式返回的(不是错误)，"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "没有就绪"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": " 和"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "真正的错误"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "使用的是同样的方式标识，如何进一步区分呢??"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "\n那就是"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "errno"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": " 中的  "
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "EAGAIN"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": " 表示的就是没有就绪。"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211544-2oqw4we",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211544-2oqw4we"
			}
		},
		{
			"ID": "20221113211217-sysiysp",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-sysiysp",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "多路转接IO"
				}
			]
		},
		{
			"ID": "20221113211217-cl16a7v",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-cl16a7v",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " 多路IO转接服务器也叫做多任务IO服务器。该类服务器实现的主旨思想是，不再由应用程序自己监视客户端连接，取而代之由内核替应用程序监视文件。"
				}
			]
		},
		{
			"ID": "20221113211217-u2wvuse",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-u2wvuse",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " 主要使用的方法有三种: "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "select"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " , "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "poll"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " , "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "epoll"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-tgoe5u1",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-tgoe5u1",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "select，poll，epoll都是IO多路复用的机制。I/O多路复用就是通过一种机制，一个进程可以监视多个描述符，一旦某个描述符就绪（一般是读就绪或者写就绪），能够通知程序进行相应的读写操作。但select，poll，epoll本质上都是同步I/O，因为他们都需要在读写事件就绪后自己负责进行读写，也就是说这个读写过程是阻塞的，而异步I/O则无需自己负责进行读写，异步I/O的实现会负责把数据从内核拷贝到用户空间。"
				}
			]
		},
		{
			"ID": "20221113211217-jlkwksw",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-jlkwksw",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "select"
				}
			]
		},
		{
			"ID": "20221113211217-19cey4e",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-19cey4e",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "系统提供select函数来实现多路复用输入/输出模型."
				}
			]
		},
		{
			"ID": "20221113211217-z9535dx",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-z9535dx",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-oixk8d6",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-oixk8d6",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-nrylxbz",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-nrylxbz",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-i72600j",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-i72600j",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "select系统调用是用来让我们的程序监视多个文件描述符的状态变化的;"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-vl63krs",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-vl63krs",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-swgyzlz",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-swgyzlz",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "程序会停在select这里等待，直到被监视的文件描述符有一个或多个发生了状态改变;"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211601-tc1upzo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211601-tc1upzo"
			}
		},
		{
			"ID": "20221113211217-751g8ui",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-751g8ui",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "select函数分析"
				}
			]
		},
		{
			"ID": "20221113211217-spx645k",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-spx645k",
				"updated": "20221113211607"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "需要导入头文件 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "sys/select.h"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\n"
				}
			]
		},
		{
			"ID": "20221113211608-vhodnes",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211608-vhodnes",
				"updated": "20221113211616"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221108151253"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221108151253-20221113211616-j90cp8i.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-yz2ybml",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-yz2ybml",
				"updated": "20221113211628"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-b7xs7tc",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-b7xs7tc",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "nfds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ": 监控的文件描述符集里最大文件描述符加1，因为此参数会告诉内核检测前多少个文件描述符的状态\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "readfds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "： 监控有读数据到达文件描述符集合，传入传出参数\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "writefds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "： 监控写数据到达文件描述符集合，传入传出参数\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "exceptfds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "： 监控异常发生达文件描述符集合,如带外数据到达异常，传入传出参数\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "timeout"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "： 定时阻塞监控时间。"
						}
					]
				},
				{
					"ID": "20221113211217-3px572t",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-3px572t",
						"updated": "20221113211628"
					},
					"Children": [
						{
							"ID": "20221113211217-e0w5orb",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-e0w5orb",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-nuwmgpv",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-nuwmgpv",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "NULL：则表示"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "select()"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "没有timeout，select将一直被阻塞，直到某个文件描述符上发生了事件;"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-4zq0wc0",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-4zq0wc0",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-syiaqot",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-syiaqot",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "0：仅检测描述符集合的状态，然后立即返回，并不等待外部事件的发生。"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-mg2zta9",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-mg2zta9",
								"updated": "20221113211628"
							},
							"Children": [
								{
									"ID": "20221113211217-qbkei83",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-qbkei83",
										"updated": "20221113211628"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "特定的时间值：使用"
										},
										{
											"Type": "NodeStrong",
											"Data": "strong",
											"Children": [
												{
													"Type": "NodeStrongA6kOpenMarker",
													"Data": "**"
												},
												{
													"Type": "NodeText",
													"Data": "timeval"
												},
												{
													"Type": "NodeStrongA6kCloseMarker",
													"Data": "**"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "设置，如果在指定的时间段里没有事件发生，"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "select()"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "将超时返回。"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211621-7ebi5fr",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211621-7ebi5fr"
			}
		},
		{
			"ID": "20221113211217-5dc7u2v",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-5dc7u2v",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "timeout的取值"
				}
			]
		},
		{
			"ID": "20221113211217-ebpr4mm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-ebpr4mm",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "timeval结构用于描述一段时间长度，如果在这个时间内，需要监视的描述符没有事件发生则函数返回，返回值为0。"
				}
			]
		},
		{
			"ID": "20221113211217-hty4l1n",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-hty4l1n",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "struct timeval {\n\tlong tv_sec; /* seconds */\n\tlong tv_usec; /* microseconds */\n};\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-toe11mu",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-toe11mu",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "fd_set的结构"
				}
			]
		},
		{
			"ID": "20221113211217-1gpe8em",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-1gpe8em",
				"updated": "20221113211640"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221108152720"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221108152720-20221113211640-qp1ebih.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-egco4ob",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-egco4ob",
				"updated": "20221113211648"
			},
			"Children": [
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221108152817"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221108152817-20221113211648-wub8r1u.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-3cej6kd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-3cej6kd",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "其实这个结构就是一个整数数组, 更严格的说, 是一个 \""
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "位图"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\". 使用位图中对应的位来表示要监视的文件描述符."
				}
			]
		},
		{
			"ID": "20221113211217-d6ndvyo",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-d6ndvyo",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "fd_set 的大小是 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "128byte"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " ，但是使用的位图结构，所以能存储 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "128 * 8"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "的fd"
				}
			]
		},
		{
			"ID": "20221113211653-lvycbnx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211653-lvycbnx"
			}
		},
		{
			"ID": "20221113211217-xaefe1i",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-xaefe1i",
				"updated": "20221113211652"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "函数返回值："
				}
			]
		},
		{
			"ID": "20221113211217-hih815t",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-hih815t",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-i2ys6fg",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-i2ys6fg",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-vh3m2vt",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-vh3m2vt",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "执行成功则"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "返回文件描述词状态已改变的个数"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-fdnlyti",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-fdnlyti",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-jby0g1q",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-jby0g1q",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "如果返回"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "0"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "代表在描述词状态改变前已超过timeout时间，没有返回"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-5v3iagf",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-5v3iagf",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-m8ii1c3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-m8ii1c3",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "当有错误发生时则返回 "
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "-1"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "，错误原因存于errno，此时参数readfds，writefds, exceptfds和timeout的值变成不可预测。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-1jqw6c9",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-1jqw6c9",
				"updated": "20221113211704"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-phjexqa",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-phjexqa",
						"updated": "20221113211704"
					},
					"Children": [
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "错误值可能为："
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "\nEBADF 文件描述词为无效的或该文件已关闭\nEINTR 此调用被信号所中断\nEINVAL 参数n 为负值。\nENOMEM 核心内存不足"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211708-36haohk",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211708-36haohk"
			}
		},
		{
			"ID": "20221113211217-h3p7pb5",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-h3p7pb5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "用来操作fd_set 的接口"
				}
			]
		},
		{
			"ID": "20221113211217-ap9y98s",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-ap9y98s",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "void FD_CLR(int fd, fd_set *set); //把文件描述符集合里fd清0\n\nint FD_ISSET(int fd, fd_set *set); //测试文件描述符集合里fd是否置1\n\nvoid FD_SET(int fd, fd_set *set); //把文件描述符集合里fd位置1\n\nvoid FD_ZERO(fd_set *set); //把文件描述符集合里所有位清0\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211711-tue7ft9",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211711-tue7ft9"
			}
		},
		{
			"ID": "20221113211217-cx401p5",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-cx401p5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "理解select执行过程"
				}
			]
		},
		{
			"ID": "20221113211217-7dkaq6f",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-7dkaq6f",
				"updated": "20221113211731"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": " 理解select模型的关键在于理解"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "fd_set"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ",为说明方便，取"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "fd_set"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "长度为1字节，"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "fd_set"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "中的每一bit可以对应一个文件描述符fd。则1字节长的"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "fd_set"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "最大可以对应8个fd."
				}
			]
		},
		{
			"ID": "20221113211217-iszkyqv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-iszkyqv",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "这是执行一次的过程"
				}
			]
		},
		{
			"ID": "20221113211217-z3qnzo9",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-z3qnzo9",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-1leu8qk",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-1leu8qk",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "(1)执行"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "fd_set set"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "; "
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "FD_ZERO(\u0026set)"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ";则set用位表示是"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "0000,0000"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "。\n(2)若"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "fd＝5"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ",执行"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "FD_SET(fd,\u0026set)"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "; 后set变为"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "0001,0000"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "(第5位置为1)\n（3）若再加入"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "fd＝2"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "，"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "fd=1"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ",则"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "set"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "变为"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "0001,0011"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "\n（4）执行 "
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "select(6,\u0026set,0,0,0)"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "阻塞等待\n（5）若"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "fd=1,fd=2"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "上都发生可读事件，则select返回，此时set变为"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "0000,0011"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "。注意："
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "没有事件发生的"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "fd=5"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "被清空"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "。"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-8x9x2rx",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-8x9x2rx",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "select()"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "因为使用输入输出型参数标识不同的含义，"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "意味着后面每一次，都需要对fd_set进行重新设置"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "!!"
				}
			]
		},
		{
			"ID": "20221113211217-whsucnv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-whsucnv",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeText",
							"Data": "但是你的程序，怎么知道你都有那些fd呢?"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "所以用户必须定义数组或者其他容器结构，来把历史fd全部保存起来，需要使用第三方数组"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-tucaxli",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-tucaxli",
				"updated": "20221113211828"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211749-uqbd1ez",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211749-uqbd1ez",
						"updated": "20221113211828"
					},
					"Children": [
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "上面的执行过程其实是有一个文件的，也就是 0 fd，怎么表示呢，为什么在上面的案例中没有？"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "\n"
						},
						{
							"Type": "NodeText",
							"Data": "其实不是没有，而是选择性省略了这个 0 fd 所在的位置，可以这样想象，在一个数组中，0号fd对应的就是下标0，3号fd对应的就是下标3，6号fd对应的就是下标6，以此类推。所以0号fd不是没有对应的bit位，而是被选择性省略了。"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211807-uw9b8i6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211807-uw9b8i6"
			}
		},
		{
			"ID": "20221113211217-0fguq31",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-0fguq31",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "socket 就绪条件"
				}
			]
		},
		{
			"ID": "20221113211217-rgqnk2z",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-rgqnk2z",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "读就绪"
				}
			]
		},
		{
			"ID": "20221113211217-8xfkl52",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-8xfkl52",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-3mrwbq5",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-3mrwbq5",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-o8kbsqt",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-o8kbsqt",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket内核中, 接收缓冲区中的字节数, 大于等于低水位标记SO_RCVLOWAT. 此时可以无阻塞的读该文件描述符, 并且返回值大于0;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-5wb1qat",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-5wb1qat",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-ymctkbc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-ymctkbc",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket TCP通信中, 对端关闭连接, 此时对该socket读, 则返回0;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-900etns",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-900etns",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-a2j8sj8",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-a2j8sj8",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "监听的socket上有新的连接请求;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-o0ksg7j",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-o0ksg7j",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-nfdm3u3",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-nfdm3u3",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket上有未处理的错误;"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-7xnshgt",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-7xnshgt",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "写就绪"
				}
			]
		},
		{
			"ID": "20221113211217-9pfx62x",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-9pfx62x",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-5j1ty8l",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-5j1ty8l",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-ll4cf4l",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-ll4cf4l",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket内核中, 发送缓冲区中的可用字节数(发送缓冲区的空闲位置大小), 大于等于低水位标记"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-a4k2zp8",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-a4k2zp8",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-m4m9ajc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-m4m9ajc",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "SO_SNDLOWAT, 此时可以无阻塞的写, 并且返回值大于0;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-sj5x8pi",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-sj5x8pi",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-erqjw3c",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-erqjw3c",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket的写操作被关闭(close或者shutdown). 对一个写操作被关闭的socket进行写操作, 会触发SIGPIPE信号;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-oo20tnp",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-oo20tnp",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-jslk40p",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-jslk40p",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket使用非阻塞connect连接成功或失败之后;"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-sac0801",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-sac0801",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-a1mx56t",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-a1mx56t",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket上有未读取的错误;"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-3hdezzr",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-3hdezzr",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "poll"
				}
			]
		},
		{
			"ID": "20221113211217-ngbd052",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-ngbd052",
				"updated": "20221113211921"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "poll 和 "
				},
				{
					"Type": "NodeBlockRef",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeBlockRefID",
							"Data": "20221113211217-jlkwksw"
						},
						{
							"Type": "NodeBlockRefSpace"
						},
						{
							"Type": "NodeBlockRefDynamicText",
							"Data": "select"
						},
						{
							"Type": "NodeCloseParen"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 的实现机制类似，本质上没有多大差别，也是管理多个套接字文件描述符，也是由内核进行轮询并根据描述符的状态进行处理，"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "但是 poll() 没有最大文件 描述符数量的限制"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "，勉强算是"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "select()"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "函数的升级版。poll 的函数原型如下\n​"
				},
				{
					"Type": "NodeImage",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeBang"
						},
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "Pasted image 20221109124637"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "assets/Pasted image 20221109124637-20221113211921-r1bpvxx.png"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				}
			]
		},
		{
			"ID": "20221113211217-lc7gtcr",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-lc7gtcr",
				"updated": "20221113211934"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-28y1xw8",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-28y1xw8",
						"updated": "20221113211934"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "参数解析\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "fds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ": 是一个 pollfd 结构类型的数组的首地址，用于存放需要检测其状态的Socket描述符\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "nfds"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ": 监控数组中有多少文件描述符需要被监控\n"
						},
						{
							"Type": "NodeMark",
							"Data": "mark",
							"Children": [
								{
									"Type": "NodeMark2OpenMarker"
								},
								{
									"Type": "NodeText",
									"Data": "timeout"
								},
								{
									"Type": "NodeMark2CloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": ": 毫秒级等待\n"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "-1"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：阻塞等，"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "#define INFTIM -1"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "（Linux中没有定义此宏，可以自己定义）\n"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "0"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：立即返回，不阻塞进程\n"
						},
						{
							"Type": "NodeCodeSpan",
							"Data": "code",
							"Children": [
								{
									"Type": "NodeCodeSpanOpenMarker"
								},
								{
									"Type": "NodeCodeSpanContent",
									"Data": "\u003e0"
								},
								{
									"Type": "NodeCodeSpanCloseMarker"
								}
							]
						},
						{
							"Type": "NodeText",
							"Data": "：等待指定毫秒数，如当前系统时间精度不够毫秒，向上取值"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-74038ux",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-74038ux",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "pollfd解析"
				}
			]
		},
		{
			"ID": "20221113211217-4v1ccev",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-4v1ccev",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "pollfd的结构"
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-q77su36",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-q77su36",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Yw=="
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "struct pollfd {\n\tint fd;        /* 文件描述符：用户设置关注的文件描述符（用户填充） */\n\tshort events; /* 监控的事件：用户关注的事件类型（用户填充） */\n\tshort revents; /* 监控事件中满足条件返回的事件：/由内核填充，就绪的事件类型 */\n};\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-cmmfj6g",
			"Type": "NodeTable",
			"TableAligns": [
				2,
				1
			],
			"Properties": {
				"colgroup": "|",
				"id": "20221113211217-cmmfj6g",
				"updated": "20221113211955"
			},
			"Children": [
				{
					"Type": "NodeTableHead",
					"Data": "thead",
					"Children": [
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeMark",
											"Data": "mark",
											"Children": [
												{
													"Type": "NodeMark2OpenMarker"
												},
												{
													"Type": "NodeStrong",
													"Data": "strong",
													"Children": [
														{
															"Type": "NodeStrongA6kOpenMarker",
															"Data": "**"
														},
														{
															"Type": "NodeText",
															"Data": "pollfd 结构监控的事件类型"
														},
														{
															"Type": "NodeStrongA6kCloseMarker",
															"Data": "**"
														}
													]
												},
												{
													"Type": "NodeMark2CloseMarker"
												}
											]
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 1
								}
							]
						},
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "宏"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 1,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "含义"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLIN"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "普通或带外优先数据可读,即"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDNORM"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDNORM"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "数据可读"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDBAND"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优先级带数据可读"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLPRI"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "高优先级可读数据"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLOUT"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "普通或带外数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLWRNORM"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLWRBAND"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优先级带数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLERR"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "发生错误"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLHUP"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "发生挂起"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLNVAL"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "描述字不是一个打开的文件"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-2jjq631",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-2jjq631",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "poll 特点"
				}
			]
		},
		{
			"ID": "20221113211217-0p01n8m",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-0p01n8m",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "相对于 Linux 下 select 和 epoll，poll 特点如下："
				}
			]
		},
		{
			"ID": "20221113211217-qnyywfx",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-qnyywfx",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-kgulafk",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-kgulafk",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-qvsdny9",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-qvsdny9",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "相较于select而言，poll的优势："
								}
							]
						},
						{
							"ID": "20221113211217-3oop53t",
							"Type": "NodeList",
							"ListData": {
								"Typ": 1
							},
							"Properties": {
								"id": "20221113211217-3oop53t",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-em972cs",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "MS4=",
										"Num": 1
									},
									"Properties": {
										"id": "20221113211217-em972cs",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-bba3anx",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-bba3anx",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "传入、传出事件分离。无需每次调用时，重新设定监听事件（重新初始化）。"
												}
											]
										}
									]
								},
								{
									"ID": "20221113211217-oml0o9j",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "Mi4=",
										"Num": 2
									},
									"Properties": {
										"id": "20221113211217-oml0o9j",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-ucm7rnm",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-ucm7rnm",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "文件描述符上限，可突破1024限制。能监控的最大上限数可使用配置文件调整。"
												}
											]
										}
									]
								},
								{
									"ID": "20221113211217-p65eins",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "My4=",
										"Num": 3
									},
									"Properties": {
										"id": "20221113211217-p65eins",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-i2p65bg",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-i2p65bg",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "相比同步阻塞型 IO 模型，poll 用单线程（进程）执行，占用资源少，不消耗太多 CPU，同时能够为多客户端提供服务。"
												}
											]
										}
									]
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-5opnu8n",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-5opnu8n",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-gd9eji6",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-gd9eji6",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "缺点和select一样："
								}
							]
						},
						{
							"ID": "20221113211217-xlr74qp",
							"Type": "NodeList",
							"ListData": {
								"Typ": 1
							},
							"Properties": {
								"id": "20221113211217-xlr74qp",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-jt7ef4a",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "MS4=",
										"Num": 1
									},
									"Properties": {
										"id": "20221113211217-jt7ef4a",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-7oupvjh",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-7oupvjh",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "大量遍历：只是返回变化的套接字文件描述符的个数，具体哪个变化需要遍历；"
												}
											]
										}
									]
								},
								{
									"ID": "20221113211217-j5qr73c",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "Mi4=",
										"Num": 2
									},
									"Properties": {
										"id": "20221113211217-j5qr73c",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-xatxeko",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-xatxeko",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "不必要的拷贝：监听的文件描述集合在应用层和内核之间来回拷贝；"
												}
											]
										}
									]
								},
								{
									"ID": "20221113211217-h2qpj7e",
									"Type": "NodeListItem",
									"ListData": {
										"Typ": 1,
										"Delimiter": 46,
										"Marker": "My4=",
										"Num": 3
									},
									"Properties": {
										"id": "20221113211217-h2qpj7e",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"ID": "20221113211217-lc8rlmy",
											"Type": "NodeParagraph",
											"Properties": {
												"id": "20221113211217-lc8rlmy",
												"updated": "20221113211217"
											},
											"Children": [
												{
													"Type": "NodeText",
													"Data": "大量并发时，少量触发（即只有少量描述符被触发）时遍历低效。"
												}
											]
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-fyjvw97",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-fyjvw97",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll"
				}
			]
		},
		{
			"ID": "20221113211217-0u57c7l",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-0u57c7l",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll是在2.6内核中提出的，是之前的select和poll的增强版本。相对于select和poll来说，epoll更加灵活，没有描述符限制。epoll使用一个文件描述符管理多个描述符，将用户关系的文件描述符的事件存放到内核的一个事件表中，这样在用户空间和内核空间的copy只需一次。"
				}
			]
		},
		{
			"ID": "20221113211217-m1t9xwr",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-m1t9xwr",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll 函数"
				}
			]
		},
		{
			"ID": "20221113211217-eoky4tu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-eoky4tu",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll操作过程需要三个接口，分别如下："
				}
			]
		},
		{
			"ID": "20221113211217-g9nalaa",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-g9nalaa",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "int epoll_create(int size)；//创建一个epoll的句柄，size用来告诉内核这个监听的数目一共有多大\nint epoll_ctl(int epfd, int op, int fd, struct epoll_event *event)；\nint epoll_wait(int epfd, struct epoll_event * events, int maxevents, int timeout);\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-28ewk1o",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-28ewk1o",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll_create()"
				}
			]
		},
		{
			"ID": "20221113211217-snut647",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-snut647",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "![[Pasted image 20221109131619.png]]\n创建一个epoll的句柄(文件描述符)，"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "size"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "用来告诉内核这个监听的数目一共有多大，这个参数不同于"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "select()"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "中的第一个参数，给出最大监听的fd+1的值，"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "参数size并不是限制了epoll所能监听的描述符最大个数，只是对内核初始分配内部数据结构的一个建议"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "。"
				},
				{
					"Type": "NodeBr",
					"Data": "br"
				},
				{
					"Type": "NodeText",
					"Data": "当创建好epoll句柄后，它就会占用一个fd值，在linux下如果查看/proc/进程id/fd/，是能够看到这个fd的，所以在使用完epoll后，必须调用"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "close()"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "关闭，否则可能导致fd被耗尽。"
				}
			]
		},
		{
			"ID": "20221113211217-zdftkz5",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-zdftkz5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll_ctl()"
				}
			]
		},
		{
			"ID": "20221113211217-joik49g",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-joik49g",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "![[Pasted image 20221109131841.png]]"
				}
			]
		},
		{
			"ID": "20221113211217-sbor8mj",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-sbor8mj",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-erez4eb",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-erez4eb",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "函数解析"
						}
					]
				},
				{
					"ID": "20221113211217-9yna1gf",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-9yna1gf",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-rgolmkn",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-rgolmkn",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-otqidc9",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-otqidc9",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeMark",
											"Data": "mark",
											"Children": [
												{
													"Type": "NodeMark2OpenMarker"
												},
												{
													"Type": "NodeText",
													"Data": "epfd"
												},
												{
													"Type": "NodeMark2CloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "：是"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "epoll_create()"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "的返回值。"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-j5995ro",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-j5995ro",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-vnuv2vl",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-vnuv2vl",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeMark",
											"Data": "mark",
											"Children": [
												{
													"Type": "NodeMark2OpenMarker"
												},
												{
													"Type": "NodeText",
													"Data": "op"
												},
												{
													"Type": "NodeMark2CloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "：表示op操作，用三个宏来分别表示添加、删除和修改对fd的监听事件。：\n- 添加"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "EPOLL_CTL_ADD"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "\n- 删除"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "EPOLL_CTL_DEL"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "\n- 修改"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "EPOLL_CTL_MOD"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-9skprpi",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-9skprpi",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-58r4v8c",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-58r4v8c",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeMark",
											"Data": "mark",
											"Children": [
												{
													"Type": "NodeMark2OpenMarker"
												},
												{
													"Type": "NodeText",
													"Data": "fd"
												},
												{
													"Type": "NodeMark2CloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "：是需要监听的fd（文件描述符）"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-gsefmsh",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-gsefmsh",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-p122jik",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-p122jik",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeMark",
											"Data": "mark",
											"Children": [
												{
													"Type": "NodeMark2OpenMarker"
												},
												{
													"Type": "NodeText",
													"Data": "epoll_event"
												},
												{
													"Type": "NodeMark2CloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "：是告诉内核需要监听什么事，"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-7ikng82",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-7ikng82",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeMark",
					"Data": "mark",
					"Children": [
						{
							"Type": "NodeMark2OpenMarker"
						},
						{
							"Type": "NodeStrong",
							"Data": "strong",
							"Children": [
								{
									"Type": "NodeStrongA6kOpenMarker",
									"Data": "**"
								},
								{
									"Type": "NodeText",
									"Data": "struct epoll_event结构如下："
								},
								{
									"Type": "NodeStrongA6kCloseMarker",
									"Data": "**"
								}
							]
						},
						{
							"Type": "NodeMark2CloseMarker"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-jds4vpf",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-jds4vpf",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "struct epoll_event {\n  uint32_t events;  /* Epoll events */\n  epoll_data_t data;  /* User data variable */\n};\n\n\n//epoll_data_t data的结构\ntypedef union epoll_data{\n\tvoid* ptr;\n\tint fd;\n\tuint32_t u32;\n\tuint64_t u64;\n}epoll_data_t;\n\n//events可以是以下几个宏的集合：\nEPOLLIN ：表示对应的文件描述符可以读（包括对端SOCKET正常关闭）；\nEPOLLOUT：表示对应的文件描述符可以写；\nEPOLLPRI：表示对应的文件描述符有紧急的数据可读（这里应该表示有带外数据到来）；\nEPOLLERR：表示对应的文件描述符发生错误；\nEPOLLHUP：表示对应的文件描述符被挂断；\nEPOLLET： 将EPOLL设为边缘触发(Edge Triggered)模式，这是相对于水平触发(Level Triggered)来说的。\nEPOLLONESHOT：只监听一次事件，当监听完这次事件之后，如果还需要继续监听这个socket的话，需要再次把这个socket加入到EPOLL队列里\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-qmj6own",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-qmj6own",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll_wait()"
				}
			]
		},
		{
			"ID": "20221113211217-fm9eo4h",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-fm9eo4h",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "![[Pasted image 20221109131905.png]]"
				}
			]
		},
		{
			"ID": "20221113211217-p82cj1w",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-p82cj1w",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-okyye8z",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-okyye8z",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-ac0eod6",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-ac0eod6",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "参数"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "events"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "是分配好的"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_event"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "结构体数组."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-sjld2i9",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-sjld2i9",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-a2dnanc",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-a2dnanc",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "epoll将会把发生的事件赋值到"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "events"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "数组中 ("
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "events"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "不可以是空指针，内核只负责把数据复制到这个"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "events"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "数组中，不会去帮助我们在用户态中分配内存)."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-o0egbx9",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-o0egbx9",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-8ry4bsw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-8ry4bsw",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "maxevents"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "告之内核这个"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "events"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "有多大，这个 "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "maxevents"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "的值不能大于创建"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_create()"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "时的"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "size"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-5sk26iu",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-5sk26iu",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-dztogmv",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-dztogmv",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "参数"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "timeout"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "是超时时间 (毫秒，0会立即返回，-1是永久阻塞)."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-fmmt7jg",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-fmmt7jg",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-l2iu2ny",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-l2iu2ny",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "返回值：如果函数调用成功，返回对应I/O上已准备好的文件描述符数目，如返回"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "0"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "表示已超时, 返回"
								},
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "小于0"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "表示函数失败."
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-dn74zzl",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-dn74zzl",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll原理"
				}
			]
		},
		{
			"ID": "20221113211217-jm1u9dn",
			"Type": "NodeList",
			"ListData": {
				"Typ": 1
			},
			"Properties": {
				"id": "20221113211217-jm1u9dn",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-yl3r1f9",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "MS4=",
						"Num": 1
					},
					"Properties": {
						"id": "20221113211217-yl3r1f9",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-llsbomw",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-llsbomw",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "首先调用epoll_create()创建一个epoll实例----在内核区，是一个eventpoll结构体类型；返回值是一个文件描述符，可以通过这个文件描述符操作内核中这块内存（通过epoll提供的API进行操作）\n![[Pasted image 20221109152121.png]]"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-nvfqdqy",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "Mi4=",
						"Num": 2
					},
					"Properties": {
						"id": "20221113211217-nvfqdqy",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-fp4l0x4",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-fp4l0x4",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "生成的eventpoll内部，有两个类型：\n- rb_root，红黑树结构；–记录需要检测的文件描述符\n- list_head，链表 --要求检测的文件描述符中，哪些文件描述符是有数据的\n优点： 与select和poll相比，直接在内核中创建一块内存，没有用户态到内核态的开销。\n![[Pasted image 20221109152202.png]]"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-xs4i1sk",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "My4=",
						"Num": 3
					},
					"Properties": {
						"id": "20221113211217-xs4i1sk",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-7wv26uf",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-7wv26uf",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "委托内核检测，"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_ctl()"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "函数\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epollfd"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "就是epoll_create()函数的返回值；\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "EPOLL_CTL_ADD"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "：指定做什么操作\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "lfd"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "：需要检测的文件描述符\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "ev"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "：内核需要检测的事件；\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "ev"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "参数的类型是："
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_event"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "ev.events = EPOLLIN"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "，检测读事件；\n- "
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "ev.data.fd = lfd"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "，检测的文件描述符值\n注意：现在只是将需要检测的文件描述符添加到红黑树rbr结构中；–比如添加了5个需要检测。\n![[Pasted image 20221109152412.png]]"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-8sxtbst",
					"Type": "NodeListItem",
					"ListData": {
						"Typ": 1,
						"Delimiter": 46,
						"Marker": "NC4=",
						"Num": 4
					},
					"Properties": {
						"id": "20221113211217-8sxtbst",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-6go82rk",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-6go82rk",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_wait()"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "，调用后，内核就会在内核中的红黑树结构中进行检测；\n- 比如红黑树中需要检测5个文件描述符，有3个文件描述符发生了变化，将这3个文件描述符添加到链表rdlist中；\n- 并且rdlist中数据会返回出去，速度是很快的（注意：可以返回具体是哪几个文件描述符）\n![[Pasted image 20221109152448.png]]"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-x6wm9xp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-x6wm9xp",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "![[Pasted image 20221109152454.png]]"
				}
			]
		},
		{
			"ID": "20221113211217-mrmx8ed",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-mrmx8ed",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll 的 LT模式和 ET模式"
				}
			]
		},
		{
			"ID": "20221113211217-twv3d56",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-twv3d56",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "epoll"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "事件有两种模型，边沿触发：edge-triggered (ET)， 水平触发：level-triggered (LT)"
				}
			]
		},
		{
			"ID": "20221113211217-i6cztyx",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-i6cztyx",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-em1lf5o",
					"Type": "NodeParagraph",
					"Properties": {
						"id": "20221113211217-em1lf5o",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"Type": "NodeText",
							"Data": "你正在吃鸡, 眼看进入了决赛圈, 你妈饭做好了, 喊你吃饭的时候有两种方式:"
						}
					]
				},
				{
					"ID": "20221113211217-qm1jeuq",
					"Type": "NodeList",
					"ListData": {
						"Typ": 1
					},
					"Properties": {
						"id": "20221113211217-qm1jeuq",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-t7xcx7j",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "MS4=",
								"Num": 1
							},
							"Properties": {
								"id": "20221113211217-t7xcx7j",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-93vz1zx",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-93vz1zx",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "如果你妈喊你一次, 你没动, 那么你妈会继续喊你第二次, 第三次...(亲妈, 水平触发)"
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-6116bvs",
							"Type": "NodeListItem",
							"ListData": {
								"Typ": 1,
								"Delimiter": 46,
								"Marker": "Mi4=",
								"Num": 2
							},
							"Properties": {
								"id": "20221113211217-6116bvs",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-37bxp1g",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-37bxp1g",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "如果你妈喊你一次, 你没动, 你妈就不管你了(后妈, 边缘触发)"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-gh19bnt",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-gh19bnt",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "水平触发(level-triggered)"
				}
			]
		},
		{
			"ID": "20221113211217-w5g5y31",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-w5g5y31",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll默认状态下就是LT工作模式."
				}
			]
		},
		{
			"ID": "20221113211217-a100fuq",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-a100fuq",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-flm1682",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-flm1682",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-vd39kte",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-vd39kte",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket接收缓冲区不为空 有数据可读 读事件一直触发"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-wfre3ej",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-wfre3ej",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-wylsver",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-wylsver",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket发送缓冲区不满 可以继续写入数据 写事件一直触发"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-inb6bs5",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-inb6bs5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-pojam4e",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-pojam4e",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-e7hweul",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-e7hweul",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-gine41s",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-gine41s",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "当epoll检测到socket上事件就绪的时候,可以不立刻进行处理.或者只处理一部分."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-74md1gq",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-74md1gq",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-xcnni0n",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-xcnni0n",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "如上面的例子,由于只读了1K数据,缓冲区中还剩1K数据,在第二次调用epoll_wait时,epoll_wait仍然会立刻返回并通知socket读事件就绪."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-6rodpob",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-6rodpob",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-ef6h81j",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-ef6h81j",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "直到缓冲区上所有的数据都被处理完,epoll_wait才不会立刻返回."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-o9t5k1t",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-o9t5k1t",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-rj633fz",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-rj633fz",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "支持阻塞读写和非阻塞读写"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-6ae922e",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-6ae922e",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "边沿触发(edge-triggered)"
				}
			]
		},
		{
			"ID": "20221113211217-horo9d7",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-horo9d7",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-gl0i01o",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-gl0i01o",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-1m1ckn0",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-1m1ckn0",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket的接收缓冲区状态变化时触发读事件，即空的接收缓冲区刚接收到数据时触发读事件"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-1f298jd",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-1f298jd",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-vrddrci",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-vrddrci",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "socket的发送缓冲区状态变化时触发写事件，即满的缓冲区刚空出空间时触发读事件"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-x0ik0df",
			"Type": "NodeBlockquote",
			"Properties": {
				"id": "20221113211217-x0ik0df",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeBlockquoteMarker",
					"Data": "\u003e"
				},
				{
					"ID": "20221113211217-2ximdp8",
					"Type": "NodeList",
					"ListData": {},
					"Properties": {
						"id": "20221113211217-2ximdp8",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-hto6ssw",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-hto6ssw",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-f01g2as",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-f01g2as",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "当epoll检测到socket上事件就绪时,必须立刻处理."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-0sthsly",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-0sthsly",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-ieiyy1l",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-ieiyy1l",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "如上面的例子,虽然只读了1K的数据,缓冲区还剩1K的数据,在第二次调用"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "epoll_wait"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "的时候,"
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "epoll_wait"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "不会再返回了."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-7xlwhof",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-7xlwhof",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-27pyigc",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-27pyigc",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "也就是说,ET模式下，文件描述符上的事件就绪后,只有一次处理机会."
										}
									]
								}
							]
						},
						{
							"ID": "20221113211217-154ccvq",
							"Type": "NodeListItem",
							"ListData": {
								"BulletChar": 42,
								"Marker": "Kg=="
							},
							"Properties": {
								"id": "20221113211217-154ccvq",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"ID": "20221113211217-g0c7coy",
									"Type": "NodeParagraph",
									"Properties": {
										"id": "20221113211217-g0c7coy",
										"updated": "20221113211217"
									},
									"Children": [
										{
											"Type": "NodeText",
											"Data": "ET的性能比LT性能更高("
										},
										{
											"Type": "NodeCodeSpan",
											"Data": "code",
											"Children": [
												{
													"Type": "NodeCodeSpanOpenMarker"
												},
												{
													"Type": "NodeCodeSpanContent",
													"Data": "epoll_wait"
												},
												{
													"Type": "NodeCodeSpanCloseMarker"
												}
											]
										},
										{
											"Type": "NodeText",
											"Data": "返回的次数少了很多).Nginx默认采用ET模式使用epoll.只支持非阻塞的读写"
										}
									]
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-55jhm06",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-55jhm06",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "边沿触发仅触发一次，水平触发会一直触发。"
				}
			]
		},
		{
			"ID": "20221113211217-lrfuewd",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-lrfuewd",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "事件宏"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-aofhibt",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-aofhibt",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-8gk9r6h",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-8gk9r6h",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-ctd0y46",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-ctd0y46",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeStrong",
									"Data": "strong",
									"Children": [
										{
											"Type": "NodeStrongA6kOpenMarker",
											"Data": "**"
										},
										{
											"Type": "NodeText",
											"Data": "EPOLLET"
										},
										{
											"Type": "NodeStrongA6kCloseMarker",
											"Data": "**"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "： 将 EPOLL设为边缘触发(Edge Triggered)模式（默认为水平触发），这是相对于水平触发(Level Triggered)来说的。"
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-5qj0i9t",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-5qj0i9t",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "libevent"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 采用水平触发， "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "nginx"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 采用边沿触发"
				}
			]
		},
		{
			"ID": "20221113211217-m7rz6ru",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-m7rz6ru",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "对比LT和ET"
				}
			]
		},
		{
			"ID": "20221113211217-mozngef",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-mozngef",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "LT是 epoll 的默认行为. "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "使用 ET 能够减少 epoll 触发的次数. 但是代价就是强逼着程序猿一次响应就绪过程中就把所有的数据都处理完"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "."
				}
			]
		},
		{
			"ID": "20221113211217-dc3nyq2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-dc3nyq2",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "相当于一个文件描述符就绪之后, 不会反复被提示就绪, 看起来就比 LT 更高效一些. 但是在 LT 情况下如果也能做到每次就绪的文件描述符都立刻处理, 不让这个就绪被重复提示的话, 其实性能也是一样的."
				}
			]
		},
		{
			"ID": "20221113211217-wnj4lrq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-wnj4lrq",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "另一方面, ET 的代码复杂程度更高了."
				}
			]
		},
		{
			"ID": "20221113211217-xq2sp26",
			"Type": "NodeHeading",
			"HeadingLevel": 4,
			"Properties": {
				"id": "20221113211217-xq2sp26",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "理解ET模式和非阻塞文件描述符"
				}
			]
		},
		{
			"ID": "20221113211217-p8zqbd3",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-p8zqbd3",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "使用 ET 模式的 epoll, 需要将文件描述设置为非阻塞. 这个不是接口上的要求, 而是 \"工程实践\" 上的要求."
				}
			]
		},
		{
			"ID": "20221113211217-zanqlx5",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-zanqlx5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "假设这样的场景: 服务器接受到一个10k的请求, 会向客户端返回一个应答数据. 如果客户端收不到应答, 不会发送第\n二个10k请求.\n![[Pasted image 20221113164115.png]]"
				}
			]
		},
		{
			"ID": "20221113211217-m24f0df",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-m24f0df",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "如果服务端写的代码是阻塞式的 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "read"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ", 并且一次只 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "read"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " "
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "1k"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 数据的话(read不能保证一次就把所有的数据都读出来,参考 [[linux常用命令#man|man]]手册的说明, 可能被信号打断), 剩下的"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "9k"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "数据就会待在缓冲区中.\n![[Pasted image 20221113203758.png]]\n此时由于epoll是"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "ET模式"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": ",并不会认为文件描述符读就绪. "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "epoll_wait"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "就不会再次返回.剩下的9k数据会一直在缓冲区中.直到下一次客户端再给服务器写数据. "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "epoll_wait"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "才能返回"
				}
			]
		},
		{
			"ID": "20221113211217-rn8tk5s",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-rn8tk5s",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "但是问题来了"
				}
			]
		},
		{
			"ID": "20221113211217-kefjr1i",
			"Type": "NodeList",
			"ListData": {},
			"Properties": {
				"id": "20221113211217-kefjr1i",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"ID": "20221113211217-06hp2o3",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-06hp2o3",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-vr3o1rr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-vr3o1rr",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "服务器只读到"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "1k"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "个数据,要"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "10k"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "读完才会给客户端返回响应数据."
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-lbsu0xi",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-lbsu0xi",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-8n8nhsr",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-8n8nhsr",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "客户端要读到服务器的响应,才会发送下一个请求"
								}
							]
						}
					]
				},
				{
					"ID": "20221113211217-9vcycbb",
					"Type": "NodeListItem",
					"ListData": {
						"BulletChar": 42,
						"Marker": "Kg=="
					},
					"Properties": {
						"id": "20221113211217-9vcycbb",
						"updated": "20221113211217"
					},
					"Children": [
						{
							"ID": "20221113211217-ynn7pii",
							"Type": "NodeParagraph",
							"Properties": {
								"id": "20221113211217-ynn7pii",
								"updated": "20221113211217"
							},
							"Children": [
								{
									"Type": "NodeText",
									"Data": "客户端发送了下一个请求,"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "epoll_wait"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								},
								{
									"Type": "NodeText",
									"Data": "才会返回,才能去读缓冲区中剩余的数据."
								}
							]
						}
					]
				}
			]
		},
		{
			"ID": "20221113211217-xai3f8b",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-xai3f8b",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "![[Pasted image 20221113203938.png]]\n所以,为了解决上述问题(阻塞 "
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "read"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": " 不一定能一下把完整的请求读完)于是就可以使用"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "非阻塞轮训"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "的方式来读缓冲区,保证一定能把完整的请求都读出来.\n而如果是"
				},
				{
					"Type": "NodeStrong",
					"Data": "strong",
					"Children": [
						{
							"Type": "NodeStrongA6kOpenMarker",
							"Data": "**"
						},
						{
							"Type": "NodeText",
							"Data": "LT"
						},
						{
							"Type": "NodeStrongA6kCloseMarker",
							"Data": "**"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "没这个问题.只要缓冲区中的数据没读完,就能够让"
				},
				{
					"Type": "NodeCodeSpan",
					"Data": "code",
					"Children": [
						{
							"Type": "NodeCodeSpanOpenMarker"
						},
						{
							"Type": "NodeCodeSpanContent",
							"Data": "epoll_wait"
						},
						{
							"Type": "NodeCodeSpanCloseMarker"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "返回文件描述符读就绪."
				}
			]
		},
		{
			"ID": "20221113211217-93ejbba",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-93ejbba",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "select实例代码"
				}
			]
		},
		{
			"ID": "20221113211217-pev2m0t",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-pev2m0t",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#include \u003ciostream\u003e\n#include \u003csys/select.h\u003e\n\n#include \"Sock.hpp\"\n\n#define NUM (sizeof(fd_set) * 8)\n\nint fd_array[NUM]; //\u003e=0 有内容,合法的fd; 如果是-1,该位置没有fd\n\nstatic void Usage(std::string proc)\n{\n    std::cout \u003c\u003c \"Usage: \" \u003c\u003c proc \u003c\u003c \" port\" \u003c\u003c std::endl;\n}\n\nint main(int argc, char* argv[])\n{\n    if (argc != 2)\n    {\n        Usage(argv[0]);\n        exit(1);\n    }\n\n    uint16_t port = (uint16_t)atoi(argv[1]);\n    int listen_sock = Sock::Socket();\n    Sock::Bind(listen_sock, port);\n    Sock::Listen(listen_sock);\n\n    for (int i = 0; i \u003c NUM; i++) // 对fd_array 初始化为-1 ， 表示没有fd进行管理。\n    {\n        fd_array[i] = -1;\n    }\n\n    //注意，这里不能使用accept ， 因为accept的本质叫做通过listen_sock获取新链接\n    // 前提是listen_sock上面有新链接，accept怎么知道有新链接呢？？\n    // 不知道！！！accept阻塞式等待\n    // 站在多路转接的视角，我们认为，链接到来，对于listen_sock,就是读事件就绪！！！\n    // 对于所有的服务器，最开始的时候，只有listen_sock\n\n    fd_set rfds;\n    fd_array[0] = listen_sock;\n    while (true)\n    {\n        FD_ZERO(\u0026rfds);           //把文件描述符集合里所有位清0\n        int max_fd = fd_array[0]; //最大的fd\n\n        for (int i = 0; i \u003c NUM; i++)\n        {\n            if (fd_array[i] == -1)\n                continue;\n\n            //下面的都是合法的fd\n            FD_SET(fd_array[i], \u0026rfds); //所有要关心读事件的fd，添加到rfds中\n\n            if (max_fd \u003c fd_array[i])\n                max_fd = fd_array[i]; //更新最大fd\n        }\n\n        struct timeval timeout = { 0, 0 };\n\n        // 我们的服务器上的所有的fd(包括listen_sock),都要交给select进行检测！！\n        // recv,read,write,send,accept : 只负责自己最核心的工作：真正的读写(listen_sock:accept)\n\n        int n = select(max_fd + 1, \u0026rfds, nullptr, nullptr, nullptr);\n        switch (n)\n        {\n        case -1: //当有错误发生时则返回 -1，错误原因存于errno\n            std::cerr \u003c\u003c \"select error\" \u003c\u003c std::endl;\n            break;\n        case 0: //返回 0 代表在描述词状态改变前已超过timeout时间\n            std::cout \u003c\u003c \"select timeout\" \u003c\u003c std::endl;\n            break;\n        default: //执行成功则 返回文件描述词状态已改变的个数\n            std::cout \u003c\u003c \"有fd对应的事件就绪啦!\" \u003c\u003c std::endl;\n            for (int i = 0; i \u003c NUM; i++)\n            {\n                if (fd_array[i] == -1)\n                    continue;\n\n                //下面的fd都是合法的fd，但合法的fd不一定是就绪的fd\n                if (FD_ISSET(fd_array[i], \u0026rfds)) //测试文件描述符集合里fd是否置1\n                {\n                    std::cout \u003c\u003c \"sock: \" \u003c\u003c fd_array[i] \u003c\u003c \" 上面有了读事件，可以读取了\" \u003c\u003c std::endl;\n                    // 一定是读事件就绪了！！！\n                    // 就绪的fd就在fd_array[i]保存！\n                    // read, recv时，一定不会被阻塞！\n                    // 读事件就绪，就一定是可以recv，read吗？？不一定！！\n                    if (fd_array[i] == listen_sock)\n                    {\n                        std::cout \u003c\u003c \"listen_sock: \" \u003c\u003c listen_sock \u003c\u003c \" 有了新的链接到来\" \u003c\u003c std::endl;\n                        // accept\n                        int sock = Sock::Accept(listen_sock);\n                        if (sock \u003e= 0)\n                        {\n                            std::cout \u003c\u003c \"listen_sock: \" \u003c\u003c listen_sock \u003c\u003c \" 获取新的链接成功\" \u003c\u003c std::endl;\n                            // 获取成功\n                            // recv,read了呢？绝对不能！\n                            // 新链接到来，不意味着有数据到来！！什么时候数据到来呢?不知道\n                            // 可是，谁可以最清楚的知道那些fd，上面可以读取了？select！\n                            // 无法直接将fd设置进select，但是，好在我们有fd_array[]!\n                            int pos = 1;\n                            for (; pos \u003c NUM; pos++)\n                            {\n                                if (fd_array[pos] == -1)\n                                    break;\n                            }\n\n                            // 1. 找到了一个位置没有被使用\n                            if (pos \u003c NUM)\n                            {\n                                std::cout \u003c\u003c \"新链接: \" \u003c\u003c sock \u003c\u003c \" 已经被添加到了数组[\" \u003c\u003c pos \u003c\u003c \"]的位置\" \u003c\u003c std::endl;\n                                fd_array[pos] = sock;\n                            }\n                            else\n                            {\n                                // 2. 找完了所有的fd_array[],都没有找到没有被使用位置\n                                // 说明服务器已经满载，没法处理新的请求了\n                                std::cout \u003c\u003c \"服务器已经满载了，关闭新的链接\" \u003c\u003c std::endl;\n                                close(sock);\n                            }\n                        }\n                    }\n                    else\n                    {\n                        // 普通的sock，读事件就绪啦！\n                        // 可以进行读取啦，recv，read\n                        // 可是，本次读取就一定能读完吗？读完，就一定没有所谓的数据包粘包问题吗？\n                        // 但是，我们今天没法解决！我们今天没有场景！仅仅用来测试\n                        std::cout \u003c\u003c \"sock: \" \u003c\u003c fd_array[i] \u003c\u003c \" 上面有普通读取\" \u003c\u003c std::endl;\n\n                        char recv_buffer[1024] = { 0 };\n                        ssize_t s = recv(fd_array[i], recv_buffer, sizeof(recv_buffer) - 1, 0);\n                        if (s \u003e 0)\n                        {\n                            recv_buffer[s] = '\\0';\n                            std::cout \u003c\u003c \"client[ \" \u003c\u003c fd_array[i] \u003c\u003c \"]# \" \u003c\u003c recv_buffer \u003c\u003c std::endl;\n                        }\n                        else if (s == 0) //对端关闭了链接\n                        {\n                            std::cout \u003c\u003c \"sock: \" \u003c\u003c fd_array[i] \u003c\u003c \"关闭了, client退出啦!\" \u003c\u003c std::endl;\n                            //对端关闭了链接\n                            close(fd_array[i]);\n                            std::cout \u003c\u003c \"已经在数组下标fd_array[\" \u003c\u003c i \u003c\u003c \"]\"\n                                \u003c\u003c \"中,去掉了sock: \" \u003c\u003c fd_array[i] \u003c\u003c std::endl;\n                            fd_array[i] = -1; //该fd已关闭，所以必须把该位置 -1。\n                        }\n                        else //读取失败\n                        {\n                            close(fd_array[i]);\n                            std::cout \u003c\u003c \"已经在数组下标fd_array[\" \u003c\u003c i \u003c\u003c \"]\"\n                                \u003c\u003c \"中,去掉了sock: \" \u003c\u003c fd_array[i] \u003c\u003c std::endl;\n                            fd_array[i] = -1;\n                        }\n                    }\n                }\n            }\n            break;\n        }\n    }\n    return 0;\n}\n\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-vishww5",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-vishww5",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "poll实例代码"
				}
			]
		},
		{
			"ID": "20221113211217-tww9qr6",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-tww9qr6",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#include \u003ciostream\u003e\n#include \u003cunistd.h\u003e\n#include \u003cpoll.h\u003e\n\nint main()\n{\n    struct pollfd rfds;\n    rfds.fd = 0;\n    rfds.events = POLLIN;\n    rfds.revents = 0;\n\n    while (true)\n    {\n        int n = poll(\u0026rfds, 1, -1);\n        switch (n)\n        {\n        case 0:\n            std::cout \u003c\u003c \"time out ...\" \u003c\u003c std::endl;\n            break;\n        case -1:\n            std::cerr \u003c\u003c \"poll error\" \u003c\u003c std::endl;\n            break;\n        default:\n            std::cout \u003c\u003c \"有事件发生...\" \u003c\u003c std::endl;\n            if (rfds.revents \u0026 POLLIN)\n            {\n                std::cout \u003c\u003c rfds.fd \u003c\u003c \" 上面的读事件发生了\" \u003c\u003c std::endl;\n                char buffer[128];\n                ssize_t s = read(0, buffer, sizeof(buffer) - 1);\n                if (s \u003e 0)\n                {\n                    std::cout \u003c\u003c \"有人说# \" \u003c\u003c buffer \u003c\u003c std::endl;\n                }\n            }\n            break;\n        }\n    }\n\n    return 0;\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-3jwfzwm",
			"Type": "NodeHeading",
			"HeadingLevel": 2,
			"Properties": {
				"id": "20221113211217-3jwfzwm",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll实例代码"
				}
			]
		},
		{
			"ID": "20221113211217-oc410gx",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-oc410gx",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "epoll 代码使用框架"
				}
			]
		},
		{
			"ID": "20221113211217-v0fr9mg",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-v0fr9mg",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "for( ; ; )  \n{  \n   nfds = epoll_wait(epfd,events,20,500);  \n   for(i=0;i\n   {  \n\t   if(events[i].data.fd==listenfd) //有新的连接  \n\t   {  \n\t\t   connfd = accept(listenfd,(sockaddr *)\u0026clientaddr, \u0026clilen); //accept这个连接  \n\t\t   ev.data.fd=connfd;  \n\t\t\tev.events=EPOLLIN|EPOLLET;  \n\t\t\tepoll_ctl(epfd,EPOLL_CTL_ADD,connfd,\u0026ev); //将新的fd添加到epoll的监听队列中  \n\t\t}\n\t\telse if( events[i].events\u0026EPOLLIN ) //接收到数据，读socket  \n\t\t{  \n\t\t\tn = read(sockfd, line, MAXLINE)) \u003c 0    //读  \n\t\t\tev.data.ptr = md;     //md为自定义类型，添加数据  \n\t\t\tev.events=EPOLLOUT|EPOLLET;  \n\t\t\tepoll_ctl(epfd,EPOLL_CTL_MOD,sockfd,\u0026ev);//修改标识符，等待下一个循环时发送数据，异步处理的精髓  \n\t\t}  \n\t\telse if(events[i].events\u0026EPOLLOUT) //有数据待发送，写socket  \n\t\t{  \n\t\t\tstruct myepoll_data* md = (myepoll_data*)events[i].data.ptr;    //取数据  \n\t\t\tsockfd = md-\u003efd;  \n\t\t\tsend( sockfd, md-\u003eptr, strlen((char*)md-\u003eptr), 0 );        //发送数据  \n\t\t\tev.data.fd=sockfd;  \n\t\t\tev.events=EPOLLIN|EPOLLET;  \n\t\t\tepoll_ctl(epfd,EPOLL_CTL_MOD,sockfd,\u0026ev); //修改标识符，等待下一个循环时接收数据  \n\t\t}  \n\t\telse  \n\t\t{  \n\t\t\t//其他的处理  \n\t\t}  \n\t}  \n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-mx9mwr8",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-mx9mwr8",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "LT 模式"
				}
			]
		},
		{
			"ID": "20221113211217-qcoukea",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-qcoukea",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#include \u003csys/epoll.h\u003e\n#include \u003ciostream\u003e\n#include \u003ccstdlib\u003e\n#include \u003cunistd.h\u003e\n\n#include \"Sock.hpp\"\n\n#define SIZE 128\n#define NUM 64\n\nstatic void Usage(std::string proc)\n{\n    std::cerr \u003c\u003c \"Usage: \" \u003c\u003c proc \u003c\u003c \" port\" \u003c\u003c std::endl;\n}\n\n// ./epoll_server port\nint main(int argc, char* argv[])\n{\n    if (argc != 2)\n    {\n        Usage(argv[0]);\n        exit(1);\n    }\n    // 1. 建立tcp 监听socket\n    uint16_t port = (uint16_t)atoi(argv[1]);\n    int listen_sock = Sock::Socket();\n    Sock::Bind(listen_sock, port);\n    Sock::Listen(listen_sock);\n\n    // 2. 创建epoll模型，获得epfd(文件描述符)\n    int epfd = epoll_create(SIZE);\n\n    // 3. 先将listen_sock和它所关心的事件，添加到内核\n    struct epoll_event ev;\n    ev.events = EPOLLIN | EPOLLET;\n    ev.data.fd = listen_sock;\n\n    epoll_ctl(epfd, EPOLL_CTL_ADD, listen_sock, \u0026ev);\n\n    // 4. 事件循环\n    volatile bool quit = false;\n    struct epoll_event revs[NUM];\n    while (!quit)\n    {\n        int timeout = -1;\n        //这里传入的数组，仅仅是尝试从内核中拿回来已经就绪的事件\n        int n = epoll_wait(epfd, revs, NUM, timeout); // TODO\n        switch (n)\n        {\n        case 0:\n            std::cout \u003c\u003c \"time out ...\" \u003c\u003c std::endl;\n            break;\n        case -1:\n            std::cerr \u003c\u003c \"epoll error ...\" \u003c\u003c std::endl;\n            break;\n        default: //有时间就绪\n            std::cout \u003c\u003c \"有事件就绪啦!\" \u003c\u003c std::endl;\n            // 5. 处理就绪事件\n            for (int i = 0; i \u003c n; i++)\n            {\n                int sock = revs[i].data.fd; //暂时方案\n                std::cout \u003c\u003c \"文件描述符: \" \u003c\u003c sock \u003c\u003c \" 上面有事件就绪啦\" \u003c\u003c std::endl;\n                if (revs[i].events \u0026 EPOLLIN)\n                {\n                    std::cout \u003c\u003c \"文件描述符: \" \u003c\u003c sock \u003c\u003c \" 读事件就绪\" \u003c\u003c std::endl;\n                    if (sock == listen_sock)\n                    {\n                        std::cout \u003c\u003c \"文件描述符: \" \u003c\u003c sock \u003c\u003c \" 链接数据就绪\" \u003c\u003c std::endl;\n\n                        // 5.1 处理链接事件\n                        int fd = Sock::Accept(listen_sock);\n                        if (fd \u003e= 0)\n                        {\n                            std::cout \u003c\u003c \"获取新链接成功啦： \" \u003c\u003c fd \u003c\u003c std::endl;\n                            //能不能立即读取呢？？不能！\n                            struct epoll_event _ev;\n                            _ev.events = EPOLLIN; // EPOLLIN | EPOLLOUT | EPOLLERR\n                            _ev.data.fd = fd;\n                            epoll_ctl(epfd, EPOLL_CTL_ADD, fd, \u0026_ev); //新的fd托管给了epoll！\n                            std::cout \u003c\u003c \"已经将\" \u003c\u003c fd \u003c\u003c \" 托管给epoll啦\" \u003c\u003c std::endl;\n                        }\n                        else\n                        {\n                            // Do Nothing!\n                        }\n                    }\n                    else\n                    {\n                        // 5.2 正常的读取处理\n                        std::cout \u003c\u003c \"文件描述符: \" \u003c\u003c sock \u003c\u003c \"正常数据就绪\" \u003c\u003c std::endl;\n                        char buffer[1024];\n                        ssize_t s = recv(sock, buffer, sizeof(buffer) - 1, 0);\n                        if (s \u003e 0)\n                        {\n                            buffer[s] = 0;\n                            std::cout \u003c\u003c \"client [\" \u003c\u003c sock \u003c\u003c \"]# \" \u003c\u003c buffer \u003c\u003c std::endl;\n\n                            // //将我们的关心事件更改成为EPOLLOUT\n                            // struct epoll_event _ev;\n                            // _ev.events = EPOLLOUT;\n                            // _ev.data.fd = sock;\n                            // epoll_ctl(epfd, EPOLL_CTL_MOD, sock, \u0026_ev);\n                        }\n                        else if (s == 0)\n                        {\n                            //对端关闭链接\n                            std::cout \u003c\u003c \"client quit \" \u003c\u003c sock \u003c\u003c std::endl;\n                            close(sock);\n                            epoll_ctl(epfd, EPOLL_CTL_DEL, sock, nullptr);\n                            std::cout \u003c\u003c \"sock: \" \u003c\u003c sock \u003c\u003c \"delete from epoll success\" \u003c\u003c std::endl;\n                        }\n                        else\n                        {\n                            //读取失败\n                            std::cout \u003c\u003c \"recv error\" \u003c\u003c std::endl;\n                            close(sock);\n                            epoll_ctl(epfd, EPOLL_CTL_DEL, sock, nullptr);\n                            std::cout \u003c\u003c \"sock: \" \u003c\u003c sock \u003c\u003c \"delete from epoll success\" \u003c\u003c std::endl;\n                        }\n                    }\n                }\n                else if (revs[i].events \u0026 EPOLLOUT)\n                {\n                    //处理写事件\n                }\n                else\n                {\n                    // TODO\n                }\n            }\n            break;\n        }\n    }\n\n    close(epfd);\n    close(listen_sock);\n    return 0;\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-ayuqlkt",
			"Type": "NodeHeading",
			"HeadingLevel": 3,
			"Properties": {
				"id": "20221113211217-ayuqlkt",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "ET 模式"
				}
			]
		},
		{
			"ID": "20221113211217-gzotnou",
			"Type": "NodeCodeBlock",
			"IsFencedCodeBlock": true,
			"Properties": {
				"id": "20221113211217-gzotnou",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeCodeBlockFenceOpenMarker",
					"Data": "```"
				},
				{
					"Type": "NodeCodeBlockFenceInfoMarker",
					"CodeBlockInfo": "Y3Bw"
				},
				{
					"Type": "NodeCodeBlockCode",
					"Data": "#include \u003cstdio.h\u003e\n#include \u003cstdlib.h\u003e\n#include \u003cunistd.h\u003e\n#include \u003cerrno.h\u003e\n#include \u003csys/socket.h\u003e\n#include \u003cnetdb.h\u003e\n#include \u003cfcntl.h\u003e\n#include \u003csys/epoll.h\u003e\n#include \u003cstring.h\u003e\n\n#define MAXEVENTS 64\n\n//函数:\n//功能:创建和绑定一个TCP socket\n//参数:端口\n//返回值:创建的socket\nstatic int\ncreate_and_bind(char* port)\n{\n    struct addrinfo hints;\n    struct addrinfo* result, * rp;\n    int s, sfd;\n\n    memset(\u0026hints, 0, sizeof(struct addrinfo));\n    hints.ai_family = AF_UNSPEC;     /* Return IPv4 and IPv6 choices */\n    hints.ai_socktype = SOCK_STREAM; /* We want a TCP socket */\n    hints.ai_flags = AI_PASSIVE;     /* All interfaces */\n\n    s = getaddrinfo(NULL, port, \u0026hints, \u0026result);\n    if (s != 0)\n    {\n        fprintf(stderr, \"getaddrinfo: %s\\n\", gai_strerror(s));\n        return -1;\n    }\n\n    for (rp = result; rp != NULL; rp = rp-\u003eai_next)\n    {\n        sfd = socket(rp-\u003eai_family, rp-\u003eai_socktype, rp-\u003eai_protocol);\n        if (sfd == -1)\n            continue;\n\n        s = bind(sfd, rp-\u003eai_addr, rp-\u003eai_addrlen);\n        if (s == 0)\n        {\n            /* We managed to bind successfully! */\n            break;\n        }\n\n        close(sfd);\n    }\n\n    if (rp == NULL)\n    {\n        fprintf(stderr, \"Could not bind\\n\");\n        return -1;\n    }\n\n    freeaddrinfo(result);\n\n    return sfd;\n}\n\n//函数\n//功能:设置socket为非阻塞的\nstatic int\nmake_socket_non_blocking(int sfd)\n{\n    int flags, s;\n\n    //得到文件状态标志\n    flags = fcntl(sfd, F_GETFL, 0);\n    if (flags == -1)\n    {\n        perror(\"fcntl\");\n        return -1;\n    }\n\n    //设置文件状态标志\n    flags |= O_NONBLOCK;\n    s = fcntl(sfd, F_SETFL, flags);\n    if (s == -1)\n    {\n        perror(\"fcntl\");\n        return -1;\n    }\n\n    return 0;\n}\n\n//端口由参数argv[1]指定\nint main(int argc, char* argv[])\n{\n    int sfd, s;\n    int efd;\n    struct epoll_event event;\n    struct epoll_event* events;\n\n    if (argc != 2)\n    {\n        fprintf(stderr, \"Usage: %s [port]\\n\", argv[0]);\n        exit(EXIT_FAILURE);\n    }\n\n    sfd = create_and_bind(argv[1]);\n    if (sfd == -1)\n        abort();\n\n    s = make_socket_non_blocking(sfd);\n    if (s == -1)\n        abort();\n\n    s = listen(sfd, SOMAXCONN);\n    if (s == -1)\n    {\n        perror(\"listen\");\n        abort();\n    }\n\n    //除了参数size被忽略外,此函数和epoll_create完全相同\n    efd = epoll_create1(0);\n    if (efd == -1)\n    {\n        perror(\"epoll_create\");\n        abort();\n    }\n\n    event.data.fd = sfd;\n    event.events = EPOLLIN | EPOLLET; //读入,边缘触发方式\n    s = epoll_ctl(efd, EPOLL_CTL_ADD, sfd, \u0026event);\n    if (s == -1)\n    {\n        perror(\"epoll_ctl\");\n        abort();\n    }\n\n    /* Buffer where events are returned */\n    events = calloc(MAXEVENTS, sizeof event);\n\n    /* The event loop */\n    while (1)\n    {\n        int n, i;\n\n        n = epoll_wait(efd, events, MAXEVENTS, -1);\n        for (i = 0; i \u003c n; i++)\n        {\n            if ((events[i].events \u0026 EPOLLERR) ||\n                (events[i].events \u0026 EPOLLHUP) ||\n                (!(events[i].events \u0026 EPOLLIN)))\n            {\n                /* An error has occured on this fd, or the socket is not\n                   ready for reading (why were we notified then?) */\n                fprintf(stderr, \"epoll error\\n\");\n                close(events[i].data.fd);\n                continue;\n            }\n\n            else if (sfd == events[i].data.fd)\n            {\n                /* We have a notification on the listening socket, which\n                   means one or more incoming connections. */\n                while (1)\n                {\n                    struct sockaddr in_addr;\n                    socklen_t in_len;\n                    int infd;\n                    char hbuf[NI_MAXHOST], sbuf[NI_MAXSERV];\n\n                    in_len = sizeof in_addr;\n                    infd = accept(sfd, \u0026in_addr, \u0026in_len);\n                    if (infd == -1)\n                    {\n                        if ((errno == EAGAIN) ||\n                            (errno == EWOULDBLOCK))\n                        {\n                            /* We have processed all incoming\n                               connections. */\n                            break;\n                        }\n                        else\n                        {\n                            perror(\"accept\");\n                            break;\n                        }\n                    }\n\n                    //将地址转化为主机名或者服务名\n                    s = getnameinfo(\u0026in_addr, in_len,\n                        hbuf, sizeof hbuf,\n                        sbuf, sizeof sbuf,\n                        NI_NUMERICHOST | NI_NUMERICSERV); // flag参数:以数字名返回\n                    //主机地址和服务地址\n\n                    if (s == 0)\n                    {\n                        printf(\"Accepted connection on descriptor %d \"\n                            \"(host=%s, port=%s)\\n\",\n                            infd, hbuf, sbuf);\n                    }\n\n                    /* Make the incoming socket non-blocking and add it to the\n                       list of fds to monitor. */\n                    s = make_socket_non_blocking(infd);\n                    if (s == -1)\n                        abort();\n\n                    event.data.fd = infd;\n                    event.events = EPOLLIN | EPOLLET;\n                    s = epoll_ctl(efd, EPOLL_CTL_ADD, infd, \u0026event);\n                    if (s == -1)\n                    {\n                        perror(\"epoll_ctl\");\n                        abort();\n                    }\n                }\n                continue;\n            }\n            else\n            {\n                /* We have data on the fd waiting to be read. Read and\n                   display it. We must read whatever data is available\n                   completely, as we are running in edge-triggered mode\n                   and won't get a notification again for the same\n                   data. */\n                int done = 0;\n\n                while (1)\n                {\n                    ssize_t count;\n                    char buf[512];\n\n                    count = read(events[i].data.fd, buf, sizeof(buf));\n                    if (count == -1)\n                    {\n                        /* If errno == EAGAIN, that means we have read all\n                           data. So go back to the main loop. */\n                        if (errno != EAGAIN)\n                        {\n                            perror(\"read\");\n                            done = 1;\n                        }\n                        break;\n                    }\n                    else if (count == 0)\n                    {\n                        /* End of file. The remote has closed the\n                           connection. */\n                        done = 1;\n                        break;\n                    }\n\n                    /* Write the buffer to standard output */\n                    s = write(1, buf, count);\n                    if (s == -1)\n                    {\n                        perror(\"write\");\n                        abort();\n                    }\n                }\n\n                if (done)\n                {\n                    printf(\"Closed connection on descriptor %d\\n\",\n                        events[i].data.fd);\n\n                    /* Closing the descriptor will make epoll remove it\n                       from the set of descriptors which are monitored. */\n                    close(events[i].data.fd);\n                }\n            }\n        }\n    }\n\n    free(events);\n    close(sfd);\n    return EXIT_SUCCESS;\n}\n"
				},
				{
					"Type": "NodeCodeBlockFenceCloseMarker",
					"Data": "```"
				}
			]
		},
		{
			"ID": "20221113211217-vpjpq56",
			"Type": "NodeHeading",
			"HeadingLevel": 1,
			"Properties": {
				"id": "20221113211217-vpjpq56",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeText",
					"Data": "引用文章"
				}
			]
		},
		{
			"ID": "20221113211217-lpbkfmt",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221113211217-lpbkfmt",
				"updated": "20221113211217"
			},
			"Children": [
				{
					"Type": "NodeLink",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "epoll详解-chaohona-ChinaUnix博客"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "http://blog.chinaunix.net/uid-24517549-id-4051156.html"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				},
				{
					"Type": "NodeText",
					"Data": "\n"
				},
				{
					"Type": "NodeLink",
					"Data": "span",
					"Children": [
						{
							"Type": "NodeOpenBracket"
						},
						{
							"Type": "NodeLinkText",
							"Data": "166-网络编程：epoll_liufeng2023的博客-CSDN博客_epoll编程"
						},
						{
							"Type": "NodeCloseBracket"
						},
						{
							"Type": "NodeOpenParen"
						},
						{
							"Type": "NodeLinkDest",
							"Data": "https://blog.csdn.net/Edward_LF/article/details/124641084"
						},
						{
							"Type": "NodeCloseParen"
						}
					]
				}
			]
		},
		{
			"ID": "20221109125958-8ee3xuq",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125958-8ee3xuq"
			}
		},
		{
			"ID": "20221109125958-9al9mgp",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125958-9al9mgp"
			}
		},
		{
			"ID": "20221109125958-lx8q02y",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125958-lx8q02y"
			}
		},
		{
			"ID": "20221109125958-2w3rg29",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125958-2w3rg29"
			}
		},
		{
			"ID": "20221109125959-qwhtc10",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-qwhtc10"
			}
		},
		{
			"ID": "20221109125959-23fn9t2",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-23fn9t2"
			}
		},
		{
			"ID": "20221109125959-r9kas8b",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-r9kas8b"
			}
		},
		{
			"ID": "20221109125959-we9j6dj",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-we9j6dj"
			}
		},
		{
			"ID": "20221109125959-zgzv6nn",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-zgzv6nn"
			}
		},
		{
			"ID": "20221109125959-fe54swg",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-fe54swg"
			}
		},
		{
			"ID": "20221109125959-8qssggf",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-8qssggf"
			}
		},
		{
			"ID": "20221109125959-q7kfafb",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-q7kfafb"
			}
		},
		{
			"ID": "20221109125959-8qrw2pv",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-8qrw2pv"
			}
		},
		{
			"ID": "20221109125959-28gfooc",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-28gfooc"
			}
		},
		{
			"ID": "20221109125959-bk5nzs4",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-bk5nzs4"
			}
		},
		{
			"ID": "20221109125959-1elc72x",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-1elc72x"
			}
		},
		{
			"ID": "20221109125959-zkfhwem",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-zkfhwem"
			}
		},
		{
			"ID": "20221109125959-24rasqu",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-24rasqu"
			}
		},
		{
			"ID": "20221109125959-0ibhaoi",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-0ibhaoi"
			}
		},
		{
			"ID": "20221109125959-nkpwpju",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-nkpwpju"
			}
		},
		{
			"ID": "20221109125959-7zik7hz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-7zik7hz"
			}
		},
		{
			"ID": "20221109125959-s00fwfm",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-s00fwfm"
			}
		},
		{
			"ID": "20221109125959-1ij3jex",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-1ij3jex"
			}
		},
		{
			"ID": "20221109125959-zu8r4q6",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-zu8r4q6"
			}
		},
		{
			"ID": "20221109125959-isj0wak",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-isj0wak"
			}
		},
		{
			"ID": "20221109125959-exba7wz",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-exba7wz"
			}
		},
		{
			"ID": "20221109125959-lnstgdh",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-lnstgdh"
			}
		},
		{
			"ID": "20221109125959-7hjj65j",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-7hjj65j"
			}
		},
		{
			"ID": "20221109125959-vlnptp7",
			"Type": "NodeParagraph",
			"Properties": {
				"id": "20221109125959-vlnptp7"
			}
		},
		{
			"ID": "20221109125903-3qqmbqm",
			"Type": "NodeTable",
			"TableAligns": [
				2,
				1
			],
			"Properties": {
				"colgroup": "|",
				"id": "20221109125903-3qqmbqm",
				"updated": "20221109125950"
			},
			"Children": [
				{
					"Type": "NodeTableHead",
					"Data": "thead",
					"Children": [
						{
							"Type": "NodeTableRow",
							"Data": "tr",
							"Children": [
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 2,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "宏"
										},
										{
											"Type": "NodeBr",
											"Data": "br"
										}
									]
								},
								{
									"Type": "NodeTableCell",
									"Data": "th",
									"TableCellAlign": 1,
									"Children": [
										{
											"Type": "NodeText",
											"Data": "含义"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLIN"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "普通或带外优先数据可读,即"
								},
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDNORM|POLLRDBAND"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDNORM"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "数据可读"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLRDBAND"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优先级带数据可读"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLPRI"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "高优先级可读数据"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLOUT"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "普通或带外数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLWRNORM"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLWRBAND"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "优先级带数据可写"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLERR"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "发生错误"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLHUP"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "发生挂起"
								}
							]
						}
					]
				},
				{
					"Type": "NodeTableRow",
					"Data": "tr",
					"Children": [
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 2,
							"Children": [
								{
									"Type": "NodeCodeSpan",
									"Data": "code",
									"Children": [
										{
											"Type": "NodeCodeSpanOpenMarker"
										},
										{
											"Type": "NodeCodeSpanContent",
											"Data": "POLLNVAL"
										},
										{
											"Type": "NodeCodeSpanCloseMarker"
										}
									]
								}
							]
						},
						{
							"Type": "NodeTableCell",
							"Data": "td",
							"TableCellAlign": 1,
							"Children": [
								{
									"Type": "NodeText",
									"Data": "描述字不是一个打开的文件"
								}
							]
						}
					]
				}
			]
		}
	]
}